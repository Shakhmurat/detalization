Array.prototype.unique=function(){var n={},r=[];for(var i=0;i<this.length;i++){if(!n[this[i]]){n[this[i]]=true;r.push(this[i]);}}
return r;};(function($){$.fn.blink=function(options){var defaults={delay:1000};options=$.extend(defaults,options);return this.each(function(){var obj=$(this);setInterval(function(){if($(obj).css("visibility")=="visible"){$(obj).css('visibility','hidden');}else{$(obj).css('visibility','visible');}},options.delay);});}}(jQuery));(function($){jQuery.fn.putCursorAtEnd=function(){return this.each(function(){$(this).focus();if(this.setSelectionRange){var len=$(this).val().length*2;this.setSelectionRange(len,len);}else{$(this).val($(this).val());}
this.scrollTop=999999;});};jQuery(document).on("ready",function(){if(jQuery(".left-card-content h1").length){if(jQuery(".left-card-content h1").text().length>28){jQuery(".left-card-content h1").css({zoom:.8});}}});})(jQuery);jQuery.extend({random:function(X){return Math.floor(X*(Math.random()%1));},randomBetween:function(MinV,MaxV){return MinV+jQuery.random(MaxV-MinV+1);}});function change_fs(obj,step){var step=step||10;if(obj.length>0){var text=obj.text(),lineH=parseInt(obj.css('line-height')),lineFs=parseInt(obj.css('font-size')),objHeight=obj.outerHeight(),currentLh=lineH*2;if(objHeight>currentLh){obj.css({fontSize:lineFs-step,lineHeight:lineH-step+'px'})}}else{return false;}}
jQuery(function($){change_fs($('.left-card-content h1'));if(navigator.userAgent.indexOf("Mac")!=-1)var isMac=1;var ua=navigator.userAgent.toLowerCase();if((ua.indexOf('safari')!=-1)&&isMac){if(ua.indexOf('chrome')>-1){$("body").addClass('chrome-mac');}else{$("body").addClass('safari-mac');$("#d_clip_container #d_clip_button").remove();$("#d_clip_container").append('<p>Ваш браузер не поддерживает Flash</p>');}}
if((ua.indexOf('firefox')!=-1)&&isMac){$("body").addClass('firefox-mac');}
$('.block-delivered .time i').blink();$('#scroller ul li').each(function(){randomReviews($(this));});$(document).on({mouseenter:function(){onReviewZindex($(this));},mouseleave:function(){offReviewZindex();$(this).removeClass('hover');}},'#scroller ul li');function onReviewZindex(el){hoverDelay=setTimeout(function(){el.addClass('hover');},200);}
function offReviewZindex(){clearTimeout(hoverDelay);}
if($('#scroller_window').length>0){$('#scroller_window').css('visibility','hidden');initPortfolioScroller();}
$(document).on('focus','.search input:text, .subscribe input:text, .clear-text input:text',function(){if(this.value==this.defaultValue){this.value='';}});$(document).on('blur','.search input:text, .subscribe input:text, .clear-text input:text',function(){if(this.value==''){this.value=this.defaultValue;}});$(document).on('focus','.search input:text, .search-toolbar-field input:text',function(){$(this).closest('.search').addClass('search-focus');});$(document).on('blur','.search input:text, .search-toolbar-field input:text',function(){$(this).closest('.search').removeClass('search-focus');$(".automlete-not-found").hide();});$.widget("custom.catcomplete",$.ui.autocomplete,{_renderMenu:function(ul,items){var that=this,currentCategory="";$.each(items,function(index,item){if(item.category!=currentCategory){ul.append("<li class='ui-autocomplete-category'>"+item.category+"</li>");currentCategory=item.category;}
that._renderItem(ul,item);});}});var main_search_cache={};var autocompleteMainSearch={minLength:3,source:function(req,resp){var term;term=req.term;if(!term){return resp([]);}
if(term in main_search_cache){return resp(main_search_cache[term]);}
return $.getJSON(BACKEND_URLS['search_full'].url(),req,function(data){main_search_cache[term]=data;return resp(data);});},focus:function(event,ui){return false;},select:function(event,ui){var $this=$(this);$this.val(ui.item.label);if(ui.item.url){location.href=ui.item.url;}
return false;},response:function(event,ui){if(ui.content.length===0){$(this).nextAll(".automlete-not-found").show();}else{$(this).nextAll(".automlete-not-found").hide();}}};var searchRenderItems=function(ul,item){if(item.price==""){return $("<li>").data("item.autocomplete",item).addClass("ui-search-autocomplete").append('<div class="autocomplete-cat-list"><a class="cf">'+item.label+'</a></div>').appendTo(ul).closest('ul').addClass("autocomplete-main-search");}else{return $("<li>").data("item.autocomplete",item).addClass("ui-search-autocomplete").append('<div class="autocomplete-cat-list"><a class="cf"><span class="search-img"><span class="search-img-wrap"><img src="'+item.image+'" /></span></span><span class="search-name-price">'+item.label+'<span class="price">'+item.price+'<i class="rub bold">руб.</i></span></span></a></div>').appendTo(ul).closest('ul').addClass("autocomplete-main-search");}};window['searchReInit']=function(){if($('.search-autocomplete').length>0){$('.search-autocomplete').catcomplete(autocompleteMainSearch).data("catcomplete")._renderItem=searchRenderItems;}};searchReInit();if($('.search-items').length>0){$('.search-items').catcomplete(autocompleteMainSearch).data("catcomplete")._renderItem=searchRenderItems;}
if($('.terms-search-items').length){var last_q='';var results=null;var resultId=0;var nf=$('#searchItemsNotFound');$('.terms-search-items').keypress(function(){var t=$(this);var q=$.trim(t.val());if(q!=last_q){var params={className:'highlight'};$(t.data('search')).unhighlight(params).highlight(q,params);results=[];$(t.data('search')).find('.'+params.className).each(function(){results.push($(this).offset().top-70);});results=results.unique().sort(function(a,b){return a-b;});resultId=0;last_q=q;}}).keyup(function(e){if(e.which!=13){return false;}
if(!results||!results.length){nf.show();return false;}
nf.hide();$('body,html').scrollTo(results[resultId]);resultId+=1;if(resultId>=results.length){resultId=0;}
return false;});}
$(document).on('click','.btn-popup[data-modal="enroll-master-class"]',function(){var $this=$(this),mcDate=$this.data('mcdate'),mctime=$this.data('mctime');$('.master-class-date input').val(mcDate);$('.master-class-time').text(mctime);});$(document).on('click','.btn-popup[data-modal="certificate-master-class"]',function(){var $this=$(this),popupId='#'+$this.data('modal'),certBgSrc=$this.data('certificate-bgsrc');$(popupId).find('.certificate-box').css('background-image','url('+certBgSrc+')');});$(document).on('click','.calendar-add-order .btn-popup[data-modal="add-order"]',function(){var $this=$(this);if($this.hasClass('active')){$this.prevAll('.calendare-order-note').hide();}});$(document).on("dialogclose",'#add-order',function(event,ui){$('.calendare-order-note').show();});if($('.calendare-order-note').length>0){setTimeout(function(){$('.calendare-order-note').remove();},15000);}
$(document).on('click','[data-modal="filter-delivery"]',function(){$(this).addClass('clicked');$('#location-city:visible').dialog('close');});getValidationMsgs($('.valid-msg'));var lg=$('.listing-grid');lg.masonry({itemSelector:'.prd-item',columnWidth:233,isFitWidth:true});lg.show();$('.listing-grid-temp').remove();if($('#fiter-tabs').length>0){$(document).on('click','.go-to-tabs a',function(){$('html, body').animate({scrollTop:$('#fiter-tabs').offset().top-50},400);$('#fiter-tabs').find('[href="'+$(this).attr('href')+'"]').trigger('click');});}
var $banner=$('.banner-container');$banner.imagesLoaded(function(){$banner.masonry({itemSelector:'.banner-item',columnWidth:50});$('#banner-tabs').tabs();$('#banner-tabs .ui-tabs-nav li a').click(function(){$banner.masonry('reload');});});$('.bubble-slider').fotorama({nav:'none'});$('.calendar-slider').fotorama({nav:'none',flexible:true});$(document).on('click','.popup-language-currency a',function(){var $this=$(this),lang=$this.find('.lang'),langClone=lang.clone(),curr=$this.find('.currency-sign'),currClone=curr.clone(),langCurrPopupId='#'+$this.closest('.popup').attr('id');if(lang.length>0){$('#lang-curr').find('.lang').replaceWith(langClone);$this.addClass('active').parent('li').siblings().find('.lang').closest('a').removeClass('active');window.location.search="language="+$("#lang-curr").find('.lang:first').text().toLowerCase();}
if(curr.length>0){$('#lang-curr').find('.currency-sign').replaceWith(currClone);$this.addClass('active').parent('li').siblings().find('.currency-sign').closest('a').removeClass('active');$('.listing-grid').trigger('reload_grid');}
return false;});var tagscountry=[{label:"Россия",value:"8 (800) 333-60-50",type:"бесплатно в России 24/7",cityLabel:"телефон в Москве",cityPhone:"+7 (495) 225-54-87"},{label:"Казахстан",value:"+7 (727) 272-01-01",type:"телефон в Казахстане"},{label:"США",value:"+1 (347) 434-93-50",type:"телефон в США"},{label:"Германия",value:"+49 (302) 178-24-38",type:"телефон в Германии"},{label:"Великобритания",value:"+44 (745) 227-54-67",type:"телефон в Великобритании"}];$(document).on('click','.dd-countries li a',function(){var $this=$(this),currLabel=$this.text(),mainPhone='',type='',cityLabel='',cityPhone='';jQuery.each(tagscountry,function(){var elem=$(this)[0];if(elem.label===currLabel){mainPhone=elem.value;type=elem.type;cityLabel=elem.cityLabel;cityPhone=elem.cityPhone;return false;}});$('.change-country > span').text(currLabel);$('.main-tel > i').text(mainPhone);(type===undefined||type=='')?$('.main-tel > .phone-note').text(''):$('.main-tel > .phone-note').text(type);(cityPhone===undefined||cityPhone=='')?$('.extra-tel > i').text(''):$('.extra-tel > i').text(cityPhone);(cityLabel===undefined||cityLabel=='')?$('.extra-tel > .phone-note').text(''):$('.extra-tel > .phone-note').text(cityLabel);$this.closest('.country-list-outer').find('li .pseudo').removeClass('chosen');$this.addClass('chosen');try{$this.closest('.popup').dialog("close");}catch(e){}
$.cookie('hphone',$this.attr('id'),{path:'/',expires:365,domain:cookie_domain});return false;});window['reShowPhones']=function(){var hphone=$.cookie('hphone');if(hphone){$('#'+hphone).trigger('click');}
$('.phones').removeClass('hidden');};reShowPhones();$(document).on('click','.dd-box-label',function(){$(this).next('.dd-box-box-wrap').show();fleXenv.initByClass("dd-box-box");$('body').append('<div class="fe-overlay" />');});$(document).on('click','.dd-box-title',function(){$(this).closest('.dd-box-box-wrap').hide();$('.fe-overlay').remove();});$(document).on('click','.dd-box-box li',function(){var $this=$(this),txt=$this.text();$this.closest('.dd-box').find('.dd-box-label span span').text(txt);if($('.fe-overlay').length){$('.fe-overlay').remove();}
$this.closest('.dd-box-box-wrap').hide();});$(document).on('click touchend','.fe-overlay',function(){$(this).remove();$('.history-dd-select .dd-box-box-wrap').hide();});$('#phones-country').tabs();$('#master-class-tabs').tabs();$('#faq-tabs').tabs();$('.faq-list').each(function(){$(this).find('.faq-a').hide();$(this).find('.faq-item').first().find('.faq-a').show();$(this).find('.faq-item').first().addClass('faq-active');});$(document).on('click','.faq-q',function(){var $this=$(this),defaultText='Раскрыть все',changeText='Свернуть все';$this.next('.faq-a').slideToggle();$this.closest('.faq-item').toggleClass('faq-active');if($this.closest('.faq-list').find('.faq-active').size()==$this.closest('.faq-list').find('.faq-item').size()){$this.closest('.faq-list').find('.toggle-all span').text(changeText);$this.closest('.faq-list').find('.toggle-all').addClass('collapsed-faq');}else{$this.closest('.faq-list').find('.toggle-all span').text(defaultText);$this.closest('.faq-list').find('.toggle-all').removeClass('collapsed-faq');}});$(document).on('click','.toggle-all',function(){var $this=$(this),defaultText='Раскрыть все',changeText='Свернуть все';if($this.hasClass('collapsed-faq')){$this.removeClass('collapsed-faq');$this.find('span').text(defaultText);$this.closest('.faq-list').find('.faq-item').removeClass('faq-active');$this.closest('.faq-list').find('.faq-a').slideUp();}else{$this.addClass('collapsed-faq');$this.find('span').text(changeText);$this.closest('.faq-list').find('.faq-item').addClass('faq-active');$this.closest('.faq-list').find('.faq-a').slideDown();}});$('.search-tabs').tabs();$(document).on('click','.search-tabs .ui-tabs-nav li a',function(){$($(this).attr('href')).find('.listing-grid').masonry('reload');});$(document).on('click','.country-cols .pseudo',function(){var $this=$(this),defaultText='Развернуть все',changeText='Свернуть все',linkDefText='еще',linkChText='свернуть';$this.closest('li').find('.toggle-countries').slideToggle().closest('li').toggleClass('country-open');if($this.closest('.country-cols').find('.country-open').size()==$this.closest('.country-cols').find('.pseudo').size()){$('.toggle-country-list > span').text(changeText);}else{$('.toggle-country-list > span').text(defaultText);}
if($this.closest('li').hasClass('country-open')){$this.find('span').text(linkChText);}else{$this.find('span').text(linkDefText);}
return false;});$(document).on('click','.toggle-country-list',function(){var defaultText='Развернуть все',changeText='Свернуть все',linkDefText='ещё',linkChText='свернуть';if($('.country-cols').find('.country-open').size()!=$('.country-cols').find('.pseudo').size()){$('.toggle-country-list > span').text(changeText);$('.country-cols > li').each(function(){if($(this).find('.pseudo').size()>0){$(this).addClass('country-open');$(this).find('.pseudo > span').text(linkChText);}});$('.country-cols .toggle-countries').slideDown();}else{$('.toggle-country-list > span').text(defaultText);$('.country-cols > li').removeClass('country-open');$('.country-cols > li .pseudo > span').text(linkDefText);$('.country-cols .toggle-countries').slideUp();}
return false;});$(document).on('click','.shop-partner .title a',function(){$(this).closest('.title').next('.shop-partner-box').slideToggle();return false;});$(document).on('click','.fileinput-button a',function(){return false;});$('#fileupload').fileupload({dataType:'json',acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,autoUpload:true,dropZone:$('.interior-photo'),done:function(e,data){$.each(data.result.files,function(index,file){$('.interior-photo .uploaded-img').remove();$('<span class="uploaded-img"><img src="'+file.url+'" /><span class="icon-delete">Delete</span></span>').appendTo('.interior-photo');});}});$('#fileupload2').fileupload({dataType:'json',acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,autoUpload:true,dropZone:$('.exterior-photo'),done:function(e,data){$.each(data.result.files,function(index,file){$('.exterior-photo .uploaded-img').remove();$('<span class="uploaded-img"><img src="'+file.url+'" /><span class="icon-delete">Delete</span></span>').appendTo('.exterior-photo');});}});$('#fileupload3').fileupload({dataType:'json',acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,autoUpload:true,dropZone:$('.smi-supp-file'),done:function(e,data){$.each(data.result.files,function(index,file){$('.smi-supp-file .uploaded-img').remove();$('<span class="uploaded-img"><img src="'+file.url+'" /><span class="icon-delete">Delete</span></span>').appendTo('.smi-supp-file');});}});$(document).on('click','.photo-upload .icon-delete',function(){$(this).closest('.photo-upload').removeClass('dragover');$(this).closest('.photo-upload').find('.uploaded-img').remove();});$(window).bind('dragover',function(e){$('.photo-upload').addClass('dragover');});$(window).bind('dragleave',function(e){$('.photo-upload').removeClass('dragover');});$(window).bind('drop',function(e){$('.photo-upload').removeClass('dragover');});$(document).on('change','.checkbox-d-a-n',function(){if($(this).is(':checked')){$('.time-start').val('00:00');$('.time-end').val('23:59');}});var cloneMessengerField=$("select.messenger-name").closest('.field-wrap').prev('.field-wrap').html(),cloneMessengerSelect=$("select.messenger-name").closest('.field-wrap').html();$("select.is-cloned-select").closest('li').addClass('first-select');$(document).on('change',"select.is-cloned-select",function(){$(this).closest('li').after('<li class="empty-label combined-item select-item"><div class="field-wrap">'+$(this).closest('.field-wrap').html()+'</div></li>');$(this).removeClass('is-cloned-select');});$(document).on('change',"select.messenger-name",function(){$(this).closest('li').after('<li class="empty-label combined-item"><div class="field-wrap field-smiddle">'+cloneMessengerField+'</div> <div class="field-wrap">'+cloneMessengerSelect+'</div></li>');$(this).removeClass('messenger-name');});$('.profile-form form').submit(function(){var data={};$('select[name=favoriteFlowers]').each(function(){var v=$(this).val();if(v){data[v]=v;}});var r=[];for(var e in data)if(data.hasOwnProperty(e)){r.push(e);}
$('#id_flowers').val(r.join(', '));return true;});var cloneSite=$(".webpartner-add-site").closest('.field-wrap').html(),cloneSiteCY=$(".webpartner-add-site").closest('.field-wrap').next('.field-wrap').html();$(document).on('click',".webpartner-add-site",function(){$(this).closest('li').after('<li class="empty-label combined-item"><div class="field-wrap field-smiddle">'+cloneSite+'</div> <div class="field-wrap field-mini">'+cloneSiteCY+'</div></li>');$(this).remove();return false;});$.datepicker.regional['ru']={closeText:'Закрыть',prevText:'&#x3c;Пред',nextText:'След&#x3e;',currentText:'Сегодня',monthNames:['Января','Февраля','Марта','Апреля','Мая','Июня','Июля','Августа','Сентября','Октября','Ноября','Декабря'],monthNamesShort:['Янв','Фев','Мар','Апр','Май','Июн','Июл','Авг','Сен','Окт','Ноя','Дек'],dayNames:['воскресенье','понедельник','вторник','среда','четверг','пятница','суббота'],dayNamesShort:['вск','пнд','втр','срд','чтв','птн','сбт'],dayNamesMin:['Вс','Пн','Вт','Ср','Чт','Пт','Сб'],weekHeader:'Не',dateFormat:'dd.mm.yy',firstDay:1,isRTL:false,showMonthAfterYear:false,yearSuffix:''};$.datepicker.setDefaults($.datepicker.regional['ru']);$('.default-calendar').datepicker({altField:".profile-birthday",numberOfMonths:2,dateFormat:"d MM yy"});$('.default-date-field').click(function(){$(this).closest('.default-select-date').find('.default-date-icon').click();});$('.curr-date-delivery-datepicker').datepicker({altField:".curr-date-delivery",numberOfMonths:2,dateFormat:"d MM yy"});$('.start-order-datepicker').datepicker({altField:".start-order-field",numberOfMonths:2,dateFormat:"d MM yy",minDate:new Date()});$('.end-order-datepicker').datepicker({altField:".end-order-field",numberOfMonths:2,dateFormat:"d MM yy",minDate:new Date()});$('.start-order-fl-datepicker').datepicker({altField:".start-order-fl-field",numberOfMonths:2,dateFormat:"dd.mm.yy"});$('.end-order-fl-datepicker').datepicker({altField:".end-order-fl-field",numberOfMonths:2,dateFormat:"dd.mm.yy"});$('.cost-delivery-datepicker').datepicker({altField:".cost-delivery-field",numberOfMonths:2,dateFormat:"d MM yy"});$('.start-report-datepicker').datepicker({altField:".start-report-field",numberOfMonths:2,dateFormat:"d MM yy"});$('.end-report-datepicker').datepicker({altField:".end-report-field",numberOfMonths:2,dateFormat:"d MM yy"});var csdd=$('.cabinet-select-date-datepicker');if(csdd.length){csdd.datepicker({numberOfMonths:2,dateFormat:"d MM yy",onSelect:function(dateText,inst){window.location.assign('/me/calendar/'+inst.selectedYear+(inst.selectedMonth+1)+'/#date'+inst.selectedYear+(inst.selectedMonth+1)+inst.selectedDay);}});var d=csdd.data('date').split('.');csdd.datepicker('setDate',new Date(d[2],d[1]-1,d[0]));}
$(document).on('click','.clear-dates',function(){var today=new Date();$('.start-order-fl-datepicker').datepicker("setDate",today);$('.end-order-fl-datepicker').datepicker("setDate",today);});if($("#d_clip_button").length>0){ZeroClipboard.setMoviePath('js/ZeroClipboard.swf');var clip=null;$(document).on('click','.banner-link',function(){clip=new ZeroClipboard.Client();clip.setHandCursor(true);clip.addEventListener('mouseOver',function(client){clip.setText($('#clipboard-area').val());});clip.glue('d_clip_button','d_clip_container');});}
$(document).on('click','.gallery-img img',function(){if($('.gallery-thumb .current').nextAll().length==0){var firstImgLink=$('.gallery-thumb li:first').addClass('current').siblings().removeClass('current').find('a').attr('href');$(this).attr('src',firstImgLink);}else{var imgLink=$('.gallery-thumb .current').removeClass('current').next().addClass('current').find('a').attr('href');$(this).attr('src',imgLink);}});$(document).on('click','.gallery-thumb a',function(){var $this=$(this),imgLink=$this.attr('href');$this.closest('li').addClass('current').siblings().removeClass('current');$('.gallery-img img').attr('src',imgLink);return false;});$(document).on('click','.enable-form-fields',function(){$(this).closest('form').find('input:disabled').prop('disabled',false);return false;});$(document).on('click','.orders-reminders .slide-details',function(){$(this).toggleClass('active');$(this).next('.current-order').slideToggle();});if($('.or-remove').attr('data-modal')){$(document).on('click','.or-remove',function(e){var $this=$(this);if(!$this.hasClass('retrieve')){$this.addClass('active');}else{$this.removeClass('retrieve');$this.removeClass('active');$this.attr('title','Удалить');$this.closest('tr').find('.form-overlay').remove();$this.attr('data-modal','cancel-order');}});}else{$(document).on('click','.or-remove',function(){var $this=$(this);var $notthis=$('.or-remove[data-id='+$this.data('id')+']');var a=$('.calendar-cell-inner .calendar_edit[data-id='+$this.data('id')+']');if(!$this.hasClass('retrieve')){$.ajax({type:'POST',url:$this.data('off'),success:function(data){}});$this.addClass('retrieve');$notthis.addClass('retrieve');$this.attr('title','Вернуть');$notthis.attr('title','Вернуть');$this.closest('tr').find('.or-box').append('<div class="form-overlay" />');$notthis.closest('tr').find('.or-box').append('<div class="form-overlay" />');a.removeClass('calendar-status');a.addClass('calendar-status-hidden');a.each(function(){var td=$(this).closest('td');if(!td.find('.calendar-status').length){td.removeClass('calendar-todo');}});}else{$.ajax({type:'POST',url:$this.data('on'),success:function(data){}});$this.removeClass('retrieve');$notthis.removeClass('retrieve');$this.attr('title','Удалить');$notthis.attr('title','Удалить');$this.closest('tr').find('.form-overlay').remove();$notthis.closest('tr').find('.form-overlay').remove();a.addClass('calendar-status');a.removeClass('calendar-status-hidden');a.each(function(){var td=$(this).closest('td');if(td.find('.calendar-status').length){td.addClass('calendar-todo');}});}});}
$(document).on('click','#cancel-order .btn-notice',function(){var $this=$('.or-remove.active');$this.addClass('retrieve');$this.attr('title','Вернуть');if(!$this.closest('tr').find('.or-box').find('.form-overlay').length){$this.closest('tr').find('.or-box').append('<div class="form-overlay" />');}
$(this).parents('.ui-dialog').find('.ui-icon-closethick').click();$this.removeAttr('data-modal');});$(document).on('click','#cancel-order .btn-cancel',function(){var $this=$('.or-remove.active');$this.removeClass('active');$(this).closest('.ui-dialog').find('.ui-icon-closethick').click();$this.attr('data-modal','cancel-order');});$(document).on('click','.order-number .pseudo',function(){var $this=$(this);$this.closest('li:not(.order-cansel)').toggleClass('open-order');$this.closest('li:not(.order-cansel)').find('.history-info').slideToggle();});$(document).on('click','.order-action',function(){var $this=$(this),attr=$this.attr('data-modal');if(typeof attr!=='undefined'&&attr!==false){if($this.closest('li').hasClass('order-cansel')){$('#reason-cancellation').dialog('destroy');$this.removeClass('active');toggleOrder($this,"Вернуть");}}else{toggleOrder($this,"Вернуть заказ");}});$(document).on('click','.reason-cancellation-popup .btn-action',function(){toggleOrder($('.order-action.active'),"Вернуть");$('.ui-widget-overlay').click();});function toggleOrder(el,msg){var text=el.find('span').text();el.closest('li').find('.history-info').slideUp();el.closest('li').removeClass('open-order');el.closest('li').toggleClass('order-cansel');el.find('span').text(text=="Отменить заказ"?msg:"Отменить заказ");}
$(document).on('click','.history-order-comment',function(){var $this=$(this);$this.toggleClass('active');$this.closest('.history-footer').find('.order-comment-form').slideToggle();});$(document).on('click','.add-order-comment',function(){var $this=$(this),currBox=$this.closest('.add-order-comment-form'),commentText=currBox.find('textarea').val().replace(/\n/g,'<br />');if(commentText!=''){currBox.find('textarea').hide();$this.hide();currBox.find('.cansel-comment').remove();currBox.find('.comment-text').remove();currBox.find('.change-comment').remove();currBox.prepend('<p class="comment-text">'+commentText+'</p>');currBox.append('<span class="pseudo change-comment"><span>изменить</span></span>');$this.closest('.history-footer').find('.history-order-comment > span').text('Комментарий к заказу');}});$('.add-order-comment-form').submit(function(){var $this=$(this),currBox=$this.closest('.add-order-comment-form');$.ajax({type:'POST',url:currBox.data('url'),data:{message:currBox.find('textarea').val()},success:function(data){}});return false;});$(document).on('click','.change-comment',function(){var $this=$(this),currBox=$this.closest('.add-order-comment-form');currBox.find('.comment-text').hide();currBox.find('textarea').show();currBox.find('.add-order-comment').show();$this.hide();});function CheckedList(link){var checkboxListParent=$('.history-list'),checkAll=false,checkboxLists=checkboxListParent.find('input:checkbox');if(!link.hasClass('check-all')){checkboxLists.attr('checked',true);}
var checkChecked=function(){checkboxLists.each(function(counter){if($(this).attr('checked')){checkAll=true;}else{checkAll=false;return false;}});};checkChecked();checkboxLists.on('change',function(){checkChecked();if(!checkAll&&link.hasClass('check-all')){link.removeClass('check-all');if(link.hasClass('pseudo')){link.find('span').text('Отметить всё');}}
if(checkAll&&!link.hasClass('check-all')){link.addClass('check-all');if(link.hasClass('pseudo')){link.find('span').text('Отменить');}else{link.text('Отменить');}}});if(link.hasClass('check-all')){checkboxLists.prop('checked',false);link.removeClass('check-all');if(link.hasClass('pseudo')){link.find('span').text('Отметить всё');}
return false;}
if(checkAll){link.addClass('check-all');if(link.hasClass('pseudo')){link.find('span').text('Отменить');}else{link.text('Отменить');}
checkboxLists.attr('checked',true);}}
$(document).on('click','.check-all-orders',function(){CheckedList($(this));});$('.print-format input:radio, .report-format input:radio').each(function(){var $this=$(this);if($this.is(':checked')){$this.closest('label').addClass('cheched');}else{$this.closest('label').removeClass('cheched');}});$(document).on('click','.print-format label, .report-format label',function(){var $this=$(this);$this.find('input:radio').attr('checked',true);$this.addClass('cheched').siblings().removeClass('cheched').find('input:radio').attr('checked',false);});$('.reason-cancellation-popup form').submit(function(){return false;})
$(document).on('click','.employee-info',function(){$(this).closest('.employee-cell').find('input:text').click();});$(document).on('click','#remove-employee .btn-notice',function(){$('.remove-employee.active').parents('.employee-cell').remove();$(this).closest('.ui-dialog').find('.ui-icon-closethick').click();});$(document).on('click','#remove-employee .btn-cancel',function(){$(this).closest('.ui-dialog').find('.ui-icon-closethick').click();});$(document).on('click','.copy-shedule',function(){var dayStart=$(this).closest('.fl-shedule-work').find('.sh-day-start').val();var dayEnd=$(this).closest('.fl-shedule-work').find('.sh-day-end').val();$('.fl-shedule-work').each(function(){if(!$(this).hasClass('shedule-rest-day')){$(this).find('.sh-day-start').val(dayStart);$(this).find('.sh-day-end').val(dayEnd);}});});$('.fl-shedule-work').each(function(){if(!$(this).hasClass('shedule-rest-day')){$(this).find('.sh-day-start').keyup(function(){if($(this).val().length===0){if($(this).parents('.fl-shedule-work').hasClass('shedule-rest-day')){return false;}
$(this).parents('.fl-shedule-work').addClass('shedule-rest-day');$(this).parents('.fl-shedule-work').append('<div class="field-wrap"><span class="rest-day">Выходной</span></div>');$(this).parents('.fl-shedule-work').find('.copy-shedule').parent().remove();}else{if($(this).parents('.fl-shedule-work').hasClass('shedule-rest-day')){$(this).parents('.fl-shedule-work').removeClass('shedule-rest-day');$(this).parents('.fl-shedule-work').find('.rest-day').parent().remove();}}}).keydown();$(this).find('.sh-day-end').keyup(function(){if($(this).val().length===0){if($(this).parents('.fl-shedule-work').hasClass('shedule-rest-day'))return false;$(this).parents('.fl-shedule-work').addClass('shedule-rest-day');$(this).parents('.fl-shedule-work').append('<div class="field-wrap"><span class="rest-day">Выходной</span></div>');$(this).parents('.fl-shedule-work').find('.copy-shedule').parent().remove();}}).keydown();$(this).find('.sh-day-start').focus(function(){$('.fl-shedule-work').find('.copy-shedule').parent().remove();$(this).parents('.fl-shedule-work').append('<div class="field-wrap"><a href="#link-21" class="copy-shedule pseudo"><span>И так каждый день</span></a></div>');});$(this).find('.sh-day-end').focus(function(){$('.fl-shedule-work').find('.copy-shedule').parent().remove();$(this).parents('.fl-shedule-work').append('<div class="field-wrap"><a href="#link-21" class="copy-shedule pseudo"><span>И так каждый день</span></a></div>');});}else{$(this).find('.sh-day-start').keyup(function(){if($(this).val().length>0){$(this).parents('.fl-shedule-work').removeClass('shedule-rest-day');$(this).parents('.fl-shedule-work').find('.rest-day').parent().remove();$('.fl-shedule-work').find('.copy-shedule').parent().remove();$(this).parents('.fl-shedule-work').append('<div class="field-wrap"><a href="#link-21" class="copy-shedule pseudo"><span>И так каждый день</span></a></div>');}}).keydown();$(this).find('.sh-day-end').keyup(function(){if($(this).val().length>0){$(this).parents('.fl-shedule-work').removeClass('shedule-rest-day');$(this).parents('.fl-shedule-work').find('.rest-day').parent().remove();$('.fl-shedule-work').find('.copy-shedule').parent().remove();$(this).parents('.fl-shedule-work').append('<div class="field-wrap"><a href="#link-21" class="copy-shedule pseudo"><span>И так каждый день</span></a></div>');}}).keydown();}});if($('#fullReport').length>0){var disabledItems=$('#fullReport').closest('.balance-report').find('input:text');if($('#fullReport').is(':checked')){disabledItems.prop('disabled',true);disabledItems.next('.default-date-icon').addClass('disabled');}
$(document).on('change','#fullReport',function(){if($('#fullReport').is(':checked')){disabledItems.prop('disabled',true);disabledItems.next('.default-date-icon').addClass('disabled');}else{disabledItems.prop('disabled',false);disabledItems.next('.default-date-icon').removeClass('disabled');}});}
$(document).on('click','.selected-curr',function(){$(this).next('.choose-curr').show();$('body').append('<div class="fe-overlay" />');});$(document).on('click','.choose-curr span',function(){var $this=$(this),currName=$this.text(),container=$this.closest('.choose-curr');container.prev('.selected-curr').text(currName);container.hide();$('.fe-overlay').remove();});$(document).on('click','.fe-overlay',function(){$('.choose-curr').hide();$('.fe-overlay').remove();});var mapId=1;$(document).on('click','.flower-kit .add-item',function(){var $this=$(this),spacer=$('<tr />',{'class':'spacer-row'}),flower=$this.closest('tr').clone(),flowerSort=flower.find('.dd-box-label span span').text(),flowerHeight=flower.find('.flower-height input').val(),mapIdText='mapFlowers';spacer.append('<td colspan="7" />');$this.closest('.flower-kit').find('.flower-type.selected').hide();if($this.closest('tr').find('.dd-box-label span span').text()=='Выберите сорт'){return false;}
flower.addClass('added-item');flower.find('.map-flowers').attr('id',mapIdText+mapId);flower.find('.map-flowers').attr('name',mapIdText+mapId);flower.find('.map-flowers').prev('img').attr('usemap','#'+mapIdText+mapId);flower.find('.dd-box').replaceWith(flowerSort);flower.find('.flower-height input').replaceWith(flowerHeight);flower.find('.flower-price .currency').remove();flower.find('.add-item').removeClass('add-item').addClass('remove-item').find('span').text('Удалить');$this.closest('tr').find('.dd-box-label span span').text('Выберите сорт');$this.closest('tr').find('input').each(function(){$(this).prop({value:''});});$this.closest('tr').find('.flower-color-main .flower-clr.active').trigger('mouseover');spacer.appendTo($this.closest('tbody'));flower.appendTo($this.closest('tbody'));mapId++;return false;});$(document).on('click','.flower-kit .remove-item',function(){if($(this).closest('tr').prev().hasClass('spacer-row')){$(this).closest('tr').prev().remove();}
$(this).closest('tr').remove();return false;});$(document).on('click','.map-flowers area',function(){var $this=$(this),id=$this.data('color'),container=$this.closest('td');$this.closest('.choose-fl-color').hide();container.append('<span class="flower-clr clr-'+id+'" />');});$(document).on('mouseout','.flower-color-main .flower-clr',function(){$(this).addClass('active');});$(document).on('mouseover','.flower-color-main .flower-clr.active',function(){var $this=$(this),container=$this.closest('td');$this.remove();container.find('.choose-fl-color').show();});$(document).on('click','.flower-type .dd-box-box li',function(){var $this=$(this),popupId=$this.closest('.popup').attr('id'),container=$('.prd-empty').clone(),txt=$this.text(),imgSrc=$this.data('image-src');$this.closest('.flower-type').addClass('selected');container.find('.btn-popup').removeClass('active');$('.prd-item .active img').attr('src',imgSrc);$('.prd-item .active .prd-name').text(txt);$('.prd-item .active[data-modal]').data('modal','edit-flower');$this.closest('.popup').find('.form-overlay').remove();if($('.prd-empty').find('[data-modal="'+popupId+'"]').hasClass('active')){$('<span class="remove-item" title="Удалить"></span>').insertAfter('.prd-empty > a');$('.prd-empty').removeClass('prd-empty');$('.listing-grid').append(container);$('.listing-grid').masonry('reload');$('#'+popupId).closest('.ui-dialog').position({my:'center top',at:'center bottom+21',of:$('.active[data-modal]'),collision:'fit none'});$('#'+popupId).find('.popup-arrow').position({my:'center top',at:'bottom+7',of:$('.active[data-modal]'),collision:'fit none'});}});$(document).on('click','.btn-popup[data-modal="add-flower"]',function(){var popup=$('#add-flower');popup.find('.flower-type').show();popup.find('.flower-sort-table').append('<div class="form-overlay" />');popup.find('.flower-sort-table .added-item').remove();popup.find('.flower-sort-table .spacer-row').remove();});$(document).on("dialogclose",'#add-flower, #edit-flower',function(event,ui){var $this=$(this),container=$('.active[data-modal]').closest('.prd-item'),inStock=0,ordered=0;$this.find('.added-item .in-stock input').each(function(index){var val=parseInt($(this).val(),10);if(!isNaN(val)){inStock+=val;}});$this.find('.added-item .ordered input').each(function(index){var val=parseInt($(this).val(),10);if(!isNaN(val)){ordered+=val;}});if(inStock>0||ordered>0){var content='<div class="prd-qty"><span class="in-stock">'+inStock+'</span><span class="ordered">'+ordered+'</span></div>';if(container.find('.prd-qty').size()>0){container.find('.prd-qty').replaceWith(content);}else{container.append(content);}}});resizePosBubble();$(window).resize(function(){resizePosBubble();});function resizePosBubble(){$('.bubble-area .text-bubble').each(function(){var $this=$(this),validationWrap=$this.closest('.bubble-area');$this.position({of:validationWrap,my:'left+39 center',at:'right center',collision:'none'});});}
if($("#news-content").length>0){$(window).scroll(function(){if($(window).scrollTop()==$(document).height()-$(window).height()){$("#news-content").append('<div id="load-more-news" />');$.ajax({url:"/news/ajax/load-more-news/"+$('#news-content .news-artice').size()+"/"+$('#news-content .news-artice:first time').attr('datetime')+"/",success:function(html){if(html&&$('#news-content .news-artice').size()<10){$("#news-content").append(html);}else{}
$("#load-more-news").remove();}});}});}
if($('.search-content').length>0){var searchPos=$('.search-content .search-fixed > div').offset().top;$(window).scroll(function(){if($(window).scrollTop()>searchPos){$(".search-content .search-area").addClass('fixed');}else{$(".search-content .search-area").removeClass('fixed');}});}
if($('.search-toolbar-terms').length>0){var searchTermPos=$('.search-toolbar-terms').offset().top;$(window).scroll(function(){if($(window).scrollTop()>searchTermPos){$('.search-toolbar-wrapper').addClass('fixed');}else{$('.search-toolbar-wrapper').removeClass('fixed');}});}
var indexHighlight=0;$(document).on('keyup','input.searh-highlight',function(e){if(e.keyCode==13){consistentSearch();}else{var el=10000000,windowTop=$(window).scrollTop(),windowHeight=$(window).height();$('input.searh-highlight').trigger('highLight');$('.ht-search-container .search-hl').each(function(){expandBox($(this),$(this).closest('li'));var offset=$(this).offset().top;if(el>offset){el=offset;}});if(el==10000000){el=$('.search-border').offset().top;}
if((el<windowTop)||(el>(windowTop+windowHeight))){$(window).scrollTop(el-windowHeight/2);}
indexHighlight=0;}});$(document).on('click','.s-hl-submit',function(e){consistentSearch();});function consistentSearch(){if($(".search-hl").length>0){var highlightLength=$(".search-hl").length-1,windowTop=$(window).scrollTop(),windowHeight=$(window).height(),currEl=$(".search-hl").eq(indexHighlight);offsetTop=currEl.offset().top;$(".search-hl").addClass('no-hl');currEl.removeClass('no-hl');$(".search-hl").parents('.toggle-countries').slideDown();if((offsetTop<windowTop)||(offsetTop>(windowTop+windowHeight))){$(window).scrollTop(offsetTop-windowHeight/2);}
indexHighlight++;if(indexHighlight>highlightLength){indexHighlight=0;}}}
$('input.searh-highlight').bind('highLight',function(){var o={words:$('input.searh-highlight').val()};highlight("ht-search-container",o);});function highlight(id,options){var o={words:'',caseSensitive:false,wordsOnly:true,template:'$1<span class="search-hl">$2</span>$3'},pattern;$.extend(true,o,options||{});o.words=o.words.replace(/[\.><+,\/#!?$%\^&\*;:{}=\_`~()]/g,'');if(o.words.length==0||o.words===''){return;}
pattern=new RegExp('(>[^<.]*)('+o.words+')([^<.]*)',o.caseSensitive?"":"ig");$('.'+id).each(function(){$('.'+id+' span.search-hl').each(function(){$(this).replaceWith($(this).text());})
var content=$(this).html();if(!content)return;$(this).html(content.replace(pattern,o.template));});}
function expandBox(el,container){if(el.is(':hidden')){if(!container.hasClass('country-open')){container.addClass('country-open').find('.toggle-countries').show();container.addClass('country-open').find('.pseudo span').text('свернуть');}}}
$(document).on('click','.go-word',function(){var letterName=$(this).text();$('.first-letter').each(function(){if(letterName==$(this).text()){$('html, body').animate({scrollTop:$(this).offset().top-70},600);}});});var countriesList=["Абхазия","Австралия","Австрия","Вануату","Ватикан","Великобритания","Кабо-Верде","Казахстан","Каймановы острова","Республика Конго","Реюньон","Россия","Уганда","Узбекистан","Украина"];var citiesList=["Анкоридж","Атланта","Абилин","Александрия","Анкоридж","Абилин","Батон-Руж","Баффало","Бейкерсфилд","Валледжо"];var autocompl_opt1={source:countriesList,minLength:0};var autocompl_opt2={source:citiesList,minLength:0};$('.country-cell input').autocomplete(autocompl_opt1).bind('focus',function(){$(this).autocomplete('search');});$('.city-cell input').autocomplete(autocompl_opt2).bind('focus',function(){$(this).autocomplete('search');});if(('#city-delivery').length>0){$("#city-delivery").tablesorter({headers:{3:{sorter:false},4:{sorter:false},5:{sorter:false}},sortList:[[0,1]]});$('#city-delivery').bind('sortStart',function(){$('.delivery-table .edited-row').each(function(){var $this=$(this),country=$this.find('.country-cell > span'),city=$this.find('.city-cell > span'),price=$this.find('.price-cell > span');$this.find('input').remove();country.replaceWith(country.text());city.replaceWith(city.text());price.replaceWith(price.text());$this.find('.edit-row > span').text('Редактировать');$this.find('.remove-row > span').text('Удалить');$this.removeClass('edited-row');});});var cityCell=$('#city-delivery thead th:first');function setSeparator(){var val='';$('#city-delivery .country-cell').each(function(){var cellVal=$(this).text();if(val!=cellVal){$(this).closest('tr').addClass('row-group');$(this).closest('tr').prev('tr').addClass('row-group-last');}
val=cellVal;});}
function checkSeparator(){if(cityCell.hasClass('headerSortDown')||cityCell.hasClass('headerSortUp')){setSeparator();$('#city-delivery').removeClass('table-sort');}else{$('#city-delivery tr').removeClass('row-group');$('#city-delivery tr').removeClass('row-group-last');$('#city-delivery').addClass('table-sort');}}
$(document).on('click','.add-delivery-table .add-row',function(){var $this=$(this),container=$this.closest('tr'),country=container.find('.country-cell input').val(),city=container.find('.city-cell input').val(),price=container.find('.price-cell input').val(),actionHtml='<td><a href="#" class="pseudo edit-row"><span>Редактировать</span></a></td>'+'<td class="last"><a href="#" class="pseudo remove-row"><span>Удалить</span></a></td>',photo=container.find('.photo-cell').html();$('.add-delivery-wrap').append('<div class="save-loader"></div>');$('#city-delivery tbody').append(addSortedItem(country,city,price,photo,actionHtml));setTimeout(function(){$('.add-delivery-wrap').find('.save-loader').remove();},1000);updateSortedItem();return false;});$('#city-delivery').bind("sortEnd",function(){checkSeparator();});}
function addSortedItem(val1,val2,val3,val4,actions){var wrap=$('<tr />');wrap.append('<td class="country-cell">'+val1+'</td>');wrap.append('<td class="city-cell">'+val2+'</td>');wrap.append('<td class="price-cell">'+val3+'</td>');wrap.append('<td class="photo-cell">'+val4+'</td>');wrap.append(actions);return wrap;}
function updateSortedItem(){var hdrorder=[],arrayindex=0;$('#city-delivery thead th').each(function(index){if($(this).hasClass('headerSortDown')){hdrorder[arrayindex]=[index,0];arrayindex++;}else if($(this).hasClass('headerSortUp')){hdrorder[arrayindex]=[index,1];arrayindex++;}});$('#city-delivery').trigger('update');$('#city-delivery').trigger('sorton',[hdrorder]);checkSeparator();}
$(document).on('click','.add-delivery-table .parcel-photo, .delivery-table .edited-row .parcel-photo',function(){$(this).toggleClass('active');});var editIteration=0;$(document).on('click','.delivery-table tbody tr td',function(e){var container=$(this).closest('tr'),country=container.find('.country-cell'),countryTxt=country.text(),city=container.find('.city-cell'),cityTxt=city.text(),price=container.find('.price-cell'),priceTxt=price.text(),containerPos=container.position().top+'px';if(container.hasClass('edited-row')){if($(e.target).hasClass('edit-row')||$(e.target).parent().hasClass('edit-row')||$(e.target).parent().hasClass('remove-row')){var countryField=container.find('.country-cell input'),cityField=container.find('.city-cell input'),priceField=container.find('.price-cell input'),countryVal=countryField.val(),cityVal=cityField.val(),priceVal=priceField.val();container.closest('.delivery-table-wrap').append('<div class="save-loader" style="top:'+containerPos+'"></div>');country.html(countryVal);city.html(cityVal);price.html(priceVal);container.find('.edit-row').find('span').text('Редактировать');container.find('.remove-row span').text('Удалить');container.removeClass('edited-row');setTimeout(function(){container.closest('.delivery-table-wrap').find('.save-loader').remove();},1000);container.appendTo($('#city-delivery tbody'));updateSortedItem();}}else{container.addClass('edited-row');container.find('.edit-row').find('span').text('Сохранить');container.find('.remove-row span').text('Отменить');var countryHtml=$('<input class="country-edit" type="text" name="delivCountry'+editIteration+'" id="delivCountry'+editIteration+'" value="'+countryTxt+'" />'),cityHtml=$('<input class="city-edit" type="text" name="delivCity'+editIteration+'" id="delivCity'+editIteration+'" value="'+cityTxt+'" />'),priceHtml=$('<input type="text" name="delivPrice'+editIteration+'" id="delivPrice'+editIteration+'" value="'+priceTxt+'" />');country.wrapInner('<span />').find('span').hide().after(countryHtml);countryHtml.autocomplete(autocompl_opt1);city.wrapInner('<span />').find('span').hide().after(cityHtml);cityHtml.autocomplete(autocompl_opt2);price.wrapInner('<span />').find('span').hide().after(priceHtml);editIteration++;}
return false;});$(document).on('click','.delivery-table .remove-row',function(){var container=$(this).closest('tr');if(container.hasClass('edited-row')){container.find('input').remove();container.find('.country-cell span').contents().unwrap();container.find('.city-cell span').contents().unwrap();container.find('.price-cell span').contents().unwrap();container.find('.edit-row span').text('Редактировать');$(this).find('span').text('Удалить');container.removeClass('edited-row');}else{container.remove();}
return false;});if((navigator.userAgent.match(/iPhone/i))||(navigator.userAgent.match(/iPod/i))||(navigator.userAgent.match(/iPad/i))){}
var fileInput=$('.form-field.file input[type=file]');fileInput.change(function(){fileInput.each(function(){var name=this.value;var reWin=/.*\\(.*)/;var fileTitle=name.replace(reWin,"$1");var reUnix=/.*\/(.*)/;fileTitle=fileTitle.replace(reUnix,"$1");if($.trim(fileTitle)!==''){fileInput.siblings('.t').html(fileTitle);}});});if(fileInput.val()!==''){fileInput.siblings('.t').html(fileInput.val());}
var hs=$('[hashstring]');var base64hand=function(){var base64hand={footer_sec:'PHA+CiAgICAgICAgICAgINCd0LDRiCDRgdC10YDRgtC40YTQuNC60LDRgiDQsdC10LfQvtC/0LDRgdC90L7RgdGC0Lgg0L7QsdC10YHQv9C10YfQtdC9INC80LXQttC00YPQvdCw0YDQvtC00L3QvtC5INC60L7QvNC/0LDQvdC40LXQuSBHb2RhZGR5ICg8YSB0YXJnZXQ9Il9ibGFuayIgaHJlZj0iaHR0cHM6Ly9zZWFsLmdvZGFkZHkuY29tL3ZlcmlmeVNlYWw/c2VhbElEPWFSWERZaFd5Zlk4OWNWQXY0bkFycVlRdmFvSzlRa00xVFdpQVFCWEROUGY4TmEydU5JZ25VRGw3NnBMWCI+0L/RgNC+0LLQtdGA0LjRgtGMPC9hPikuCiAgICAgICAgICAgINCf0LvQsNGC0LXQttC4INC+0LHRgNCw0LHQsNGC0YvQstCw0Y7RgiDQsNCy0YLQvtGA0LjQt9C+0LLQsNC90L3Ri9C1INC/0YDQvtGG0LXRgdGB0LjQvdCz0L7QstGL0LUg0YbQtdC90YLRgNGLIENsb3VkcGF5bWVudHMucnUg0LggQ3liZXJwbGF0LnJ1CiAgICAgICAgICAgIDxicj48YnI+CiAgICAgICAgICAgINCf0LvQsNGC0LXQttC90YvQuSDRgdC10YDQstC40YEgQ2xvdWRwYXltZW50cyDQvtCx0LvQsNC00LDQtdGCIDxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSJodHRwczovL2Nsb3VkcGF5bWVudHMucnUvaW1hZ2VzL3BjaS5qcGciPtGB0LXRgNGC0LjRhNC40LrQsNGC0L7QvCDQsdC10LfQvtC/0LDRgdC90L7RgdGC0Lg8L2E+IFBDSSBEU1MgTGV2ZWwgMSDQstC10YDRgdC40LggMy4wLgogICAgICAgICAgICDQlNC70Y8g0LfQsNGJ0LjRgtGLINC00LDQvdC90YvRhSDQv9C+0LrRg9C/0LDRgtC10LvRjyDQuNGB0L/QvtC70YzQt9GD0LXRgtGB0Y8g0YjQuNGE0YDQvtCy0LDQvdC40LUg0L3QsCDRgtGA0LDQvdGB0L/QvtGA0YLQvdC+0Lwg0YPRgNC+0LLQvdC1IOKAlCBTU0wvVExTINC4INC90LAKICAgICAgICAgICAg0L/RgNC40LrQu9Cw0LTQvdC+0Lwg0YPRgNC+0LLQvdC1INCw0LvQs9C+0YDQuNGC0LzQvtC8IFJTQSDRgSDQtNC70LjQvdC+0Lkg0LrQu9GO0YfQsCAyMDQ4INCx0LjRgi4g0J/QvtGB0LvQtSDQv9GA0L7RhdC+0LbQtNC10L3QuNGPCiAgICAgICAgICAgINGC0YDQsNC90LfQsNC60YbQuNC4INCy0YHQtSDQtNCw0L3QvdGL0LUg0LLQsNGI0LXQuSDQutCw0YDRgtGLINGD0LTQsNC70Y/RjtGC0YHRjywg0YfRgtC+INCz0LDRgNCw0L3RgtC40YDRg9C10YIg0LHQtdC30L7Qv9Cw0YHQvdC+0YHRgtGMCiAgICAgICAgICAgINC/0LvQsNGC0LXQttCwINC4INC60L7QvdGE0LjQtNC10L3RhtC40LDQu9GM0L3QvtGB0YLRjCDQtNCw0L3QvdGL0YUuCiAgICAgICAgPC9wPg=='};$('[hashstringhand]').each(function(){var key=$(this).attr('hashstringhand');$(this).replaceWith(Base64.decode(base64hand[key]));});};if(hs.length){var keys=[];hs.each(function(){keys.push($(this).attr('hashstring'));});$.ajax({url:'/ajax/base64/',data:{keys:keys.join(',')},success:function(data){data.forEach(function(d){$('[hashstring='+d['key']+']').replaceWith(Base64.decode(d['val']));});autoCompleteReInit();searchReInit();datePickerReInit();reShowPhones();reInitResize();reInitChat();reInitChatFlex();initTels();re_setup_all();$('.listing-grid').trigger('attach_categories');$(document).on('click','.product-arrows',function(){var self=$(this);var l=self.attr('href')+'#top'+$(document).scrollTop();window.location.assign(l);return false;});if(window.location.hash.substr(0,4)=='#top'){var top=+window.location.hash.substr(4);$(document).scrollTop(top);}
base64hand();}});}else{base64hand();}
$(document).trigger('renderpage.finish');var move_fn=function(){$('.move').each(function(){var to=$(this).data('to');$(to).replaceWith($(this).html());$(this).remove();});};$('body').on('moverun',move_fn);move_fn();$('.span_l').click(function(){window.location.assign($(this).data('href'));});$('.calendar_add').click(function(){var self=$(this);var d=self.data('date').split('.');$('.start-order-datepicker').datepicker('setDate',new Date(d[2],d[1]-1,d[0]));var p=$('#add-order').find('#id_period');p.data('startdate',self.data('date'));p.trigger('change');});$('.calendar_edit').click(function(){var self=$(this);var co=$('#current-order');var d=self.data('date').split('.');var date_start=new Date(d[2],d[1]-1,d[0]);$('.curr-date-delivery-datepicker').datepicker('setDate',date_start);var date_end=self.data('date_end');if(date_end){d=date_end.split('.');$('.end-order-datepicker').datepicker('setDate',new Date(d[2],d[1]-1,d[0]));}else{$('.end-order-datepicker').datepicker('setDate',date_start);}
var ei=$('.current-order .order-extra-info');if(self.data('period')!='once'){ei.hide().siblings().show();}else{ei.show().siblings().hide();}
co.find('#id_period').val(self.data('period'));co.find('#id_period').data('startdate',self.data('date'));co.find('#id_name').val(self.data('name'));co.find('#id_subject').val(self.data('subject'));co.find('#orderId').val(self.data('id'));var g=co.find('#orderDeleteId');g.data('id',self.data('id'));g.data('off',g.data('off-temp').replace('/123321/','/'+self.data('id')+'/'));g.data('on',g.data('on-temp').replace('/123321/','/'+self.data('id')+'/'));g.removeClass('retrieve');var sp=co.find('#orderSelectPresent');sp.attr('href',sp.data('href').replace('/123321/','/'+self.data('id')+'/'));self.closest('td > div').addClass('btn-popup active');});$('#current-order, #order-reminder').on('dialogclose',function(event,ui){$('td > div.btn-popup.active').removeClass('btn-popup active');});$('.calendar-todo').click(function(e){if(!$(e.target).hasClass('calendar_edit')){$('.calendar_edit',$(this)).eq(0).click();return false;}});$('.calendar-order-done').click(function(e){if(!$(e.target).hasClass('calendar_order')){$('.calendar_order',$(this)).eq(0).click();return false;}});$('.period select').change(function(){var v=$(this).val();var date=new Date.today();var start=$(this).data('startdate');if(start){var d=start.split('.');date=new Date(d[2],d[1]-1,d[0]);}
if(v=='week'){date=date.add({days:7});}else if(v=='month'){date=date.add({months:1});}else if(v=='year'){date=date.add({years:1});}
$('.end-order-datepicker').datepicker('setDate',date);});var calendar_order=function(self){var ort=$('#order-reminder-text');var orb=$('#order-reminder-button');var orh=$('#order-reminder-title');var orpb=$('#order-repeat-button');var orpt=$('#order-repeat-text');var tr=$('.calendar_order.pseudo[data-id="'+self.data('id')+'"]').closest('tr');orh.text(self.data('head-text'));orh.attr('href',self.data('head-link'));orpt.text(self.data('repeat-text'));orpb.unbind('click').click(function(){window.location.assign(self.data('repeat-link'));});if(+self.data('state')){ort.text(self.data('text-on'));orb.text(self.data('button-off'));orb.data('action',self.data('off'));tr.find('.form-overlay').remove();}else{ort.text(self.data('text-off'));orb.text(self.data('button-on'));orb.data('action',self.data('on'));tr.find('.or-box').append('<div class="form-overlay" />');}
if(!self.find('span').length){self.closest('td > div').addClass('btn-popup active');}};$('.calendar_order').click(function(){var self=$(this);calendar_order(self);});$(document).on('click','#order-reminder-button',function(){var self=$(this);$.ajax({type:'POST',url:self.data('action'),success:function(data){var l=$('.calendar_order[data-id="'+data['id']+'"]');l.data('state',data['state']);calendar_order(l);}});});if(window.location.hash=='#login'){var ul=$('.user-login');if(ul.length){$('.user-login').click();}else{window.location.assign('/me/')}}
if(window.location.hash.slice(0,6)=='#order'){$(window.location.hash).find('.order-number .pseudo > span').click();}
if(window.location.hash=='#add-review'){$('[data-modal=add-review-form]').click();}
if(window.location.href.indexOf('?next=')!=-1){var ul=$('.user-login');if(ul.length){$('.user-login').click();}}
$('#go_old span:eq(1)').click(function(){var self=$(this);self.parent().hide();$.cookie('old_close',1,{path:'/',expires:365,domain:cookie_domain});return false;});$(document).on('click','.go_roses',function(){var u=$(this).data('url');if(u){window.location.assign(u);return false;}
var n=$('#fiter-tabs > div[aria-hidden=false]').attr('id').replace('fitertabs-','');$('#filter-category-'+n+'-bouquets-with [data-filter="63~8"]').click();$('html, body').animate({scrollTop:$('#slogan').offset().top},400);return false;});if($('#listing-grid').length){$('#go_up').click(function(){$('html, body').animate({scrollTop:0},400);return false;});var ft=$('footer').offset().top;var bh=$('body').height();setInterval(function(){ft=$('footer').offset().top;},1000);$(document).resize(function(){bh=$('body').height();});$(document).scroll(function(){var st=$(window).scrollTop();if(st>500&&st+bh<ft){$('#go_up').show();}else{$('#go_up').hide();}});}});function onResizeMonitor(){jQuery('.listing-grid').masonry('reload');}
function getValidationMsgs(msgs){if(msgs.length>0){msgs.each(function(){var $this=jQuery(this),validationWrap=$this.closest('div'),topPadd=parseInt(validationWrap.css('padding-top'),10),myPos='left+16 center+'+topPadd,atPos='right center';if($this.hasClass('left-msg')){myPos='right-16 center+'+topPadd;atPos='left center';}
$this.position({of:validationWrap,my:myPos,at:atPos,collision:'none'});});}}
function randomReviews(el){$=jQuery;var th=el,reviewHeight=th.outerHeight(),contHeight=$('#scroller_window').height(),maxTopPos=100,minWidth=350;if(reviewHeight>contHeight){maxTopPos=0;minWidth=400;}else{maxTopPos=contHeight-reviewHeight;}
th.css({'width':$.randomBetween(minWidth,520)+'px','margin-top':$.randomBetween(0,maxTopPos)+'px','margin-left':-$.randomBetween(60,180)+'px','z-index':$.randomBetween(0,5)});}
jQuery(function($){$(document).on('click','.chkt-collapsed .checkout-head',function(){$(this).toggleClass('active');$(this).next('.checkout-inner').slideToggle();$(this).find('.h').toggleClass('hidden');});$('.change-delivery').click(function(e){var $this=$('.change-delivery'),defaultText='сменить',changeText='вернуть';if(!$this.hasClass('return')){$this.addClass('return').find('span').text(changeText);$('.delivery-automlete').show().focus();$('.point-delivery').hide();e.stopPropagation();}else{$this.removeClass('return').find('span').text(defaultText);$('.delivery-automlete').hide();$('.point-delivery').show();}});$(document).on('keyup',function(e){if((e.keyCode==27)&&($('.change-delivery').hasClass('return'))){$('#changeDelivery').click();}});$('html').on('click',function(){if($('.delivery-automlete').length>0&&$('.delivery-automlete').is(':visible')){$('.delivery-automlete').hide();$('.point-delivery').show();$('.change-delivery').removeClass('return').find('span').text('сменить');}});$('.delivery-automlete').click(function(e){e.stopPropagation();});var complete_cache={};var autocompleteCheckout={minLength:0,source:function(req,resp){var term;term=req.term;if(!term){return resp([]);}
if(term in complete_cache){return resp(complete_cache[term]);}
return $.getJSON(window.BACKEND_URLS['search_city'].url(),req,function(data){complete_cache[term]=data;return resp(data);});},focus:function(event,ui){$('.delivery-automlete').val(ui.item.label+", "+ui.item.value);return false;},select:function(event,ui){var $this=$(this);$this.val(ui.item.label+", "+ui.item.value);$('.point-delivery').show().text(ui.item.label+", "+ui.item.value);$('.change-delivery').removeClass('return').find('span').text('сменить');$this.hide();$('.point-delivery').closest('.chkt-field').find('.errorlist').hide();ShopCart.setCity(ui.item.id,function(){window.checkout_action();});return false;}};var checloutRenderItems=function(ul,item){return $("<li>").data("item.autocomplete",item).append("<a><span>"+item.label+",</span> "+item.value+"</a>").appendTo(ul);};if($('.delivery-automlete').length>0){$('.delivery-automlete').autocomplete(autocompleteCheckout).data("autocomplete")._renderItem=checloutRenderItems;}
$(document).on('click','.select-recipient-list a',function(e){e.preventDefault();var popupId=$(this).closest('.popup').attr('id');var data=$(this).data();$("#id_receiver_address").val(data['address']);ShopCart.setCity(data['addressCityId'],function(){window.checkout_action();});$('.point-delivery').show().text(data['addressCity']+", "+data['addressCountry']);$("#id_receiver_email").val(data['addressEmail']);$("#id_receiver_name").val(data['addressName']);$("#id_receiver_phone").val(data['addressPhone']);$(this).closest('.popup').dialog('close');$('[data-modal="'+popupId+'"]').removeClass('active');check_button();});$(document).on('click','.select-recipient-list .remove',function(e){e.preventDefault();var id=$(this).data('id'),message=$(this).data('confirm'),form=$(this).closest('form');form.find('[name=remove_id]').val(id);form.submit();});window['setCheckoutDate']=function(){$('.checkout-calendar').datepicker('destroy');var timeForMonth=['24:00-06:00','06:00-09:00','09:00-12:00','12:00-15:00','15:00-18:00','18:00-20:00','20:00-23:00','23:00-24:00'];var cartData=$("#filter-delivery-cart-data");var chktDate=$('#chktDate');var defaultDate=new Date(cartData.data('dateraw')||new Date());$.datepicker.setDefaults($.datepicker.regional['ru']);$('.checkout-calendar').datepicker({altField:".chkt-date-field",numberOfMonths:2,dateFormat:"d MM yy, DD",minDate:new Date(cartData.data('datemin')||chktDate.data('datemin')||new Date()),defaultDate:defaultDate,onSelect:function(dateText,inst){$('.chkt-select-date .chkt-date-icon').click();if(inst.selectedMonth>timeForMonth.length){$('#chktTime').val(timeForMonth[3]);}else{$('#chktTime').val(timeForMonth[inst.selectedMonth]);}
var date=$(this).datepicker("getDate");window.ShopCart.setDate([date.getDate(),date.getMonth()+1,date.getFullYear()].join("/"),function(){window.checkout_action();});}});};setCheckoutDate();$('.chkt-date-field').click(function(){$(this).closest('.chkt-select-date').find('.chkt-date-icon').click();});$(document).on('click','.date-few-days a',function(){$(this).addClass('radio-select').siblings().removeClass('radio-select');return false;});$(document).on('click','.date-few-days .date-today',function(){$('.checkout-calendar').datepicker("setDate","today");});$(document).on('click','.date-few-days .date-tomorrow',function(){$('.checkout-calendar').datepicker("setDate",+1);});$(document).on('click','.date-few-days .date-after-tomorrow',function(){$('.checkout-calendar').datepicker("setDate",+2);});$('#chktTime').change(function(){if($('#chktTime .option-exact-time').attr('selected')){$('.exact-time').css('visibility','visible');}else{$('.exact-time').css('visibility','hidden');}});$(document).on('click','.social-address',function(){var $this=$(this);if(!$this.hasClass('active')){$this.toggleClass('active pseudo').siblings().removeClass('active').addClass('pseudo');$('.address-textarea').toggle();$('.social-address-field').toggle();if($this.closest('li').siblings().find('.form-overlay').size()>0){$('.dd-recipient').show();$this.closest('li').siblings().find('.form-overlay').remove();}else{$('.dd-recipient').hide();$this.closest('li').siblings().append('<div class="form-overlay" />');}}});$('.gift-tabs').tabs().addClass('ui-tabs-vertical ui-helper-clearfix');$('.postcard-tabs').tabs().addClass('ui-tabs-vertical ui-helper-clearfix');$(document).on('click','.postcard-item .btn',function(){var postcardText=$(this).closest('.postcard-item').find('p').html().replace(/<br\s?\/?>/g,"\n");postcardText=postcardText.replace(/\n+/g,"\n").strip();postcardText+='\n';$('.postcard-textarea').val(postcardText);$(this).closest('.popup').dialog('close');$('.postcard-textarea').focus();});$('.payment-tabs').tabs({active:false,collapsible:true});$('.payment-tabs .ui-tabs-nav li:last-child').addClass('last');$('#exactTime').inputmask({mask:'99:99',placeholder:' '});if($('#order-received-link').length>0){$("#order-received-link").click(function(e){var t=this;e.preventDefault();window.checkout_action('phone_order',{'phone':$("#yourPhone").val()},function(result){$("#order-received").append("<span class=\"popup-arrow\" />").dialog({draggable:false,modal:true,resizable:false,width:"auto",position:{my:"center top",at:"center bottom+21",of:t,collision:"fit none"}}).find(".popup-arrow").position({my:"center top",at:"bottom+7",of:t,collision:"fit none"});});$(document).on('click','#order-received .btn-action',function(){$('#order-received-link').click().remove();});$(document).on('dialogclose','#order-received',function(event,ui){$('#order-received-link').remove();});});}
$(document).on('change','#id_email',function(){window.checkout_action();});$(document).on('click','.active-errors',function(){$('.checkout .required').each(function(){var $this=$(this),container=$this.closest('div'),telVal=$('#yourPhone').val(),matches=telVal.match(/\d+/g);if(((matches==null)||$this.val()=='')&&!container.hasClass('validation-error')){container.addClass('validation-error').append('<span class="valid-msg">Номер телефона должен состоять из 11 цифр или более и включать код города и страны.</span>');var error=container.find('.valid-msg'),errorW=error.width(),winW=$(window).width();if(errorW>270){error.css('white-space','normal');if(winW<=1050){error.css('width','210px');}else{error.css('width','270px');}}
container.find('.valid-msg').position({of:$this,my:'left center',at:'right+16 center',collision:'none'});}});if($('.validation-error').length>0){var firstErrorPos=$('.validation-error:first').offset().top;$('html, body').animate({scrollTop:firstErrorPos-62+'px'},600);}
return false;});$(document).on('focus','.validation-error input, .validation-error textarea',function(){var validCont=$(this).closest('.validation-error');validCont.removeClass('validation-error');validCont.find('.valid-msg').fadeOut(2000,function(){$(this).remove();});});$("#id_time").change(function(){var time=$(this).find('option:selected').text();$(".special-conditions .delivery-time").html(time);}).change();function remember(selector){$(selector).each(function(){if($(this).prop('type')=='hidden'){return}
var name=$(this).attr('name');var v=$.cookie(name);if(v){if($(this).prop('type')=='checkbox'){if(parseInt(v)){$(this).prop('checked','checked');}}else if(!$(this).val()){$(this).val(v);}}
$(this).change(function(){var v=$(this).val();if($(this).prop('type')=='checkbox'){v=$(this).is(':checked')?1:0;}
$.cookie(name,v,{path:'/',expires:365,domain:cookie_domain});});});}
remember('#yourPhone, #id_email, #id_receiver_name, #id_receiver_phone, #id_receiver_address, #id_photo, #id_wishes');function validate_email(e){var emailReg=/^([\w\.\+-]+@([\w-]+\.)+[\w-]{2,4})?$/;return e&&emailReg.test($.trim(e));}
var check_button=function(o,is_first){var empty=false;$('input.required').each(function(){var self=$(this);if(self.attr('name')=='email'){if(!validate_email(self.val())){empty=true;}}else if(!self.val()){empty=true;}});if(empty||!$('#id_agree').prop('checked')){$('.btn-pay').attr('disabled','disabled');}else{if(!is_first){$('.btn-pay').removeAttr('disabled');}}};check_button(undefined,true);$('input').on('keyup change focusout',check_button);$('#id_agree').change(check_button);window.checkout_check_button=check_button;});jQuery(function($){var TLMonthWidth=0,TLMonthPos=0,TLPos=0,TLContainerWidth=parseInt($('.timeline-scroll-wrap').width(),10),TLSlideArea=parseInt(TLContainerWidth*0.7,10);$('.timeline-month').each(function(){TLMonthWidth+=$(this).width();});var TLWidth=$('.timeline-scroll').width()-TLMonthWidth;$('.calendar-timeline').hide();$('.timeline-scroll').draggable({axis:'x',drag:function(event,ui){if(ui.position.left>0){ui.position.left=0;}
if(ui.position.left<TLWidth){ui.position.left=TLWidth;}
$(this).trigger('moved',[ui.position.left]);}});$(document).on('click','.timeline-prev',function(){var leftPos=parseInt($('.timeline-scroll').css('left')),stepLength=10,step=parseInt(TLSlideArea/stepLength,10);for(var i=0;i<stepLength;i++){leftPos+=step;if(leftPos>0){leftPos=0;$('.timeline-scroll').animate({left:leftPos},100);$('.timeline-scroll').trigger('moved',[leftPos,'anim']);break;}else{$('.timeline-scroll').animate({left:leftPos},100);$('.timeline-scroll').trigger('moved',[leftPos,'anim']);}}});$(document).on('click','.timeline-next',function(){var leftPos=parseInt($('.timeline-scroll').css('left')),stepLength=10,step=parseInt(TLSlideArea/stepLength,10);for(var i=0;i<stepLength;i++){leftPos-=step;if(leftPos<TLWidth){leftPos=TLWidth;$('.timeline-scroll').animate({left:leftPos},100);$('.timeline-scroll').trigger('moved',[leftPos,'anim']);break;}else{$('.timeline-scroll').animate({left:leftPos},100);$('.timeline-scroll').trigger('moved',[leftPos,'anim']);}};});$(document).bind('moved','.timeline-scroll',function(event,iuPos,animated){var animated=animated||false;$('.timeline-month').each(function(index){var $this=$(this),leftVisDistanse=15;currMonth=$this.find('.timeline-current-month');TLPos=Math.abs(iuPos);TLMonthPos=parseInt($this.position().left,10);TLMonthPosW=parseInt(TLMonthPos+$this.width(),10);if((TLPos>=TLMonthPos)&&(TLPos<TLMonthPosW)){$this.addClass('current');}else{$this.removeClass('current');}
if((TLPos>=(TLMonthPos+leftVisDistanse))&&(TLPos<TLMonthPosW)){if(animated){currMonth.show().animate({left:TLPos-TLMonthPos+'px'},100);}else{currMonth.show().css({left:TLPos-TLMonthPos+'px'});}}else{if(animated){currMonth.hide().animate({left:TLPos-TLMonthPos+'px'},100);}else{currMonth.hide();}}});});function TLresize(){TLWidth=$('.timeline-scroll').width()-TLMonthWidth;$(document).on('drag','.timeline-scroll',function(event,ui){if(ui.position.left>0){ui.position.left=0;}
if(ui.position.left<TLWidth){ui.position.left=TLWidth;}
$(this).trigger('moved',ui.position.left);});}
$(window).resize(function(){TLresize();});var activeBubble='tl-active';var bubbleZindex=1;$.fn.dayShow=function(){var $this=$(this),bubble=$this.find('.timeline-bubble'),bubbleContent=$this.find('.tl-content'),bubbleArrow=$this.find('.tl-arrow');$this.addClass(activeBubble);var bubbleHeight=bubbleContent.height();bubble.animate({width:174,height:bubbleHeight,marginLeft:-84,marginBottom:30},500,'easeInOutExpo').find('.tl-icon').hide();bubbleContent.animate({opacity:1},500,'easeInOutExpo');bubbleArrow.animate({bottom:-14},500,'easeInOutExpo');return $this;};$.fn.dayHide=function(){var $this=$(this),bubble=$this.find('.timeline-bubble'),bubbleContent=$this.find('.tl-content'),bubbleArrow=$this.find('.tl-arrow');$this.removeClass(activeBubble);bubble.animate({width:20,height:20,marginLeft:-7,marginBottom:16},200,'easeInOutExpo',function(){$this.find('.tl-icon').show();});bubbleContent.animate({opacity:0},200,'easeInOutExpo');bubbleArrow.animate({bottom:-10},200,'easeInOutExpo');return $this;};$(document).on('click','.timeline-month li',function(){if($(this).hasClass(activeBubble)){$(this).dayHide();$(this).find('.timeline-bubble').css('z-index',0);}else{$(this).dayShow();$(this).find('.timeline-bubble').css('z-index',bubbleZindex);bubbleZindex++;$('.timeline-month .tl-active .timeline-bubble').hover(function(){onBubbleZindex($(this).closest('.tl-active'));},function(){if($(this).closest('.tl-active').hasClass('.hover')){offBubbleZindex();}
$(this).closest('.tl-active').removeClass('hover');});function onBubbleZindex(el){var hoverDelay=setTimeout(function(){el.addClass('hover');},200);}
function offBubbleZindex(){clearTimeout(hoverDelay);}}});$(document).on('click','.cabinet-calendar-main',function(){var timeLineBlock=$(this).find('.calendar-timeline');if(timeLineBlock.is(':hidden')){timeLineBlock.closest('.cabinet-calendar-main').find('.colapse-calendar').trigger('click');}
return false;});$(document).on('click','.calendar-toolbar .colapse-calendar',function(){$('.calendar-timeline').slideToggle();var text=$(this).find('span').html(),orderLink=$(this).closest('.calendar-toolbar').find('.add-order-link');if(orderLink.is(':hidden')){orderLink.show();}else{orderLink.hide();}
$(this).find('span').html(text=="Свернуть<br>календарь"?"Раскрыть<br>календарь":"Свернуть<br>календарь");});});function addZoom(elem){elem.addimagezoom({magnifiersize:[300,300],zoomrange:[3,3],cursorshadecolor:'#fff',cursorshadeborder:'1px solid #888',cursorshadeopacity:0.5,cursorshade:true,initzoomablefade:false});}
function fancyZoomInit(elem){element=elem||jQuery('.big-item-img > a');element.fancybox({overlayOpacity:1,overlayColor:'#fff',hideOnContentClick:true,scrolling:'no',titleShow:false,opacity:true,autoScale:false,autoDimensions:false,transitionIn:'elastic',transitionOut:'elastic',onStart:function(){}});}
function destroyLessCache(pathToCss){var host=window.location.host;var protocol=window.location.protocol;var keyPrefix=protocol+'//'+host+pathToCss;for(var key in window.localStorage){if(key.indexOf(keyPrefix)===0){delete window.localStorage[key];}}}
function changeReview(wrapperContainer,$){var wrapperContainer=wrapperContainer||false;if(!wrapperContainer.length)return false;wrapperContainer.children('div').each(function(){var reviewBlock=$(this),reviewBlocks=wrapperContainer.children('div'),countElements=reviewBlocks.length-1,index=reviewBlock.index();if(reviewBlock.hasClass('active')){if(index!=countElements){reviewBlocks.eq(index+1).stop().fadeIn(750,function(){$(this).addClass('active');});reviewBlocks.eq(index+1).siblings().css({position:'absolute'}).removeClass('active').stop().fadeOut(750,function(){$(this).removeAttr('style');});return false;}else{reviewBlocks.eq(0).siblings().css({position:'absolute'}).removeClass('active').hide().removeAttr('style');reviewBlocks.eq(0).stop().fadeIn(750).addClass('active');return false;}}});}
jQuery(function($){keyCodes={enterKey:13,upKey:38,downKey:40,escKey:27};var insertNextDay=function(){var dayarray=new Array("Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"),date=new Date(),nextDay=dayarray[parseInt(date.getDay())];if(!$('.day-of-week').length){return false}
$('.day-of-week').each(function(){$(this).text(nextDay);});}();$('.sh-day-start, .sh-day-end').timeEntry({show24Hours:true,separator:':',spinnerImage:'',defaultTime:'12:00AM',useMouseWheel:true,appendText:'',showSeconds:false});$(document).on('click','.review-next-link',function(){changeReview($('.reviews-wrapper'),$);return false;});$(document).on('click','.text-toggler',function(){$(this).closest('.text-toggle').toggleClass('active');$(this).siblings('.text-toggled').slideToggle();});change_fs($('.text-content-outer').find('h1'),5);$('#msg-tabs').tabs();$('#msg-tabs-cf').tabs();$(document).on('click','.form-toggler',function(){var togglerElement=$(this),toggledElement=$('.form-toggled'),cancelLink=toggledElement.find('.cancel-link');togglerElement.siblings(toggledElement).animate({opacity:1},{queue:false},250);togglerElement.siblings(toggledElement).slideDown(450);togglerElement.hide(0);cancelLink.on('click',function(){togglerElement.siblings(toggledElement).slideUp(500,function(){togglerElement.show(0);});togglerElement.siblings(toggledElement).animate({opacity:0},{queue:false},150);$(this).die('click');return false;});$(this).die('click');return false;});$(document).on('click','.rb-tabs label',function(){var elem=$(this),activeElem=elem.parent('li');activeElem.addClass('active').siblings().removeClass('active');activeElem.find('input[type=radio]').attr('checked','checked');});function doneRequest(target,info){var form=target||false,info=info||false,overlayHtml='<div class="form-overlay" />',overlayElem=$('.form-overlay'),messageBlock=$('.form-info-block'),submitBtn=form.find('.btn-action');if(!form)return false;form.find('input').each(function(){$(this).attr("disabled","disabled");});if(!form.find(overlayElem).length){form.append(overlayHtml);}
submitBtn.hide(0);if(!info){form.find(messageBlock).fadeIn(500);}
return false;}
$('#enroll-mc-form, #purchase-gift-form, #purchase-certificate-form').submit(function(){doneRequest($(this));return false;});$('#print-orders-form').submit(function(){if($(this).find('#report-link').is(':checked')){$('.form-info-block.cl').fadeIn(500);}
if($(this).find('#byEmail').is(':checked')){$('.form-info-block.cf').fadeIn(500);}
doneRequest($(this),true);return false;});$('.image-slider').each(function(){$(this).fotorama({nav:'dots',transition:'fade',cropToFit:true,zoomToFit:false,margin:0,arrows:false,loop:true,minPadding:0,flexible:false,onShowImg:function(data){var totalCount=$(this).find('.fotorama__thumb').length,currentNumber=data.index+1,navigationBlock=$('.slider-navigation'),navigationCauntBlock=$(this).siblings(navigationBlock).find('.nav-count'),countNavigation=currentNumber+'/'+totalCount;navigationCauntBlock.html(countNavigation);}});});$(document).on('click','.slider-nav-arrow',function(){var arrow=$(this),fotorama=arrow.closest('.image-slider-wrapper').find('.image-slider').fotorama();if(arrow.hasClass('next-img')){fotorama.trigger('showimg','next');}
if(arrow.hasClass('prev-img')){fotorama.trigger('showimg','prev');}
return false;});$('.block-fade-toggle').click(function(){$('.block-fade-toggled').fadeToggle(500);$(this).toggleClass('active');if(!$(this).hasClass('no-text-change')){if($(this).hasClass('active')){$(this).find('span').text('скрыть форму');}else{$(this).find('span').text('заполните форму');}}else{return false;}
return false;});var tooltipTimeout;$(document).on('mouseenter','[data-type="tooltip"]',function(){if(!$(this).hasClass('active')){$(this).trigger('click');var popupId=$(this).data('modal');$('#'+popupId).addClass('popup-tooltip').prev('.ui-dialog-titlebar').remove();}
clearTimeout(tooltipTimeout);});$(document).on('mouseenter','.popup-tooltip',function(){clearTimeout(tooltipTimeout);});$(document).on('mouseleave','[data-type="tooltip"]',function(){var $this=$(this);if($this.hasClass('active')){var popupId=$this.data('modal');tooltipTimeout=setTimeout(function(){$('#'+popupId).dialog('close');},1000);}});$(document).on('mouseleave','.popup-tooltip',function(){var popupId=$(this).attr('id');tooltipTimeout=setTimeout(function(){$('#'+popupId).dialog('close');},1000);});$(document).on('click','a[data-payment], *[data-payment]',function(){var paymentSelect=$(this),headerText=paymentSelect.attr('title')||paymentSelect.text(),paymentTable=$('.payment-list'),headerBlock=$('.payment-header'),iconBlock=$('#payment-icon-block'),paymentType=paymentSelect.data().payment,paymentIconClass=paymentType+'-icon',paymentBlock=$('#'+paymentType);headerBlock.find('h2').children('span').text(headerText);iconBlock.removeAttr('class').addClass(paymentIconClass);if(paymentBlock.is(':hidden')){paymentBlock.fadeIn({queue:false});paymentBlock.siblings('.payment-body').hide();paymentSelect.closest('.payment-tabs').slideToggle({queue:false},'fast');headerBlock.find('.block-fade-toggle').toggleClass('active');}
if(!$('#credit-card-pmt').is(':hidden')){$('.payment-msg-block').show();}else{$('.payment-msg-block').hide();}
if(paymentSelect.attr('href')){paymentTable.find('input').each(function(){$(this).removeAttr('checked');});return false;}});function callbackCOmplete(){}
$('.big-item-img > a').fancybox({overlayOpacity:1,overlayColor:'#fff',hideOnContentClick:true,scrolling:'no',titleShow:false,opacity:true,autoScale:true,centerOnScroll:false,autoDimensions:true,margin:0,padding:0,transitionIn:'fade',transitionOut:'fade',onStart:function(){saveScroll=$(document).scrollTop();var ovr='<div class="fl-popup-overlay"></div>'
$('body').append(ovr);$('#wrapper').animate({opacity:0},{duration:100});$(document).scrollTop(0);},onComplete:function(){$('#wrapper').height(this.height);$('#fancybox-wrap').css({'top':0});},onClosed:function(){$('#wrapper').height('auto').animate({opacity:1});$(document).scrollTop(saveScroll);$('body').find('.fl-popup-overlay').remove();}});$('.has-foto').fancybox({showCloseButton:false});var numbreList=[{label:'+1 США и Канада',value:'+1',country:'США и Канада'},{label:'+1242 Багамские Острова',value:'+1242',country:'Багамские Острова'},{label:'+1246 Барбадос',value:'+1246',country:'Барбадос'},{label:'+1264 Ангилья',value:'+1264',country:'Ангилья'},{label:'+1268 Антигуа и Барбуда',value:'+1268',country:'Антигуа и Барбуда'},{label:'+1284 Британские Виргинские острова',value:'+1284',country:'Британские Виргинские острова'},{label:'+1340 Американские Виргинские острова',value:'+1340',country:'Американские Виргинские острова'},{label:'+1345 Каймановы острова',value:'+1345',country:'Каймановы острова'},{label:'+1441 Бермудские острова',value:'+1441',country:'Бермудские острова'},{label:'+1473 Гренада',value:'+1473',country:'Гренада'},{label:'+1649 Тёркс и Кайкос',value:'+1649',country:'Тёркс и Кайкос'},{label:'+1664 Монтсеррат',value:'+1664',country:'Монтсеррат'},{label:'+1670 Северные Марианские острова Сайпан',value:'+1670',country:'Северные Марианские острова Сайпан'},{label:'+1671 Гуам',value:'+1671',country:'Гуам'},{label:'+1684 Американское Самоа',value:'+1684',country:'Американское Самоа'},{label:'+1721 Синт-Маартен',value:'+1721',country:'Синт-Маартен'},{label:'+1758 Сент-Люсия',value:'+1758',country:'Сент-Люсия'},{label:'+1767 Доминика',value:'+1767',country:'Доминика'},{label:'+1784 Сент-Винсент и Гренадины',value:'+1784',country:'Сент-Винсент и Гренадины'},{label:'+1809 Доминиканская Республика',value:'+1809',country:'Доминиканская Республика'},{label:'+1829 Доминиканская Республика',value:'+1829',country:'Доминиканская Республика'},{label:'+1849 Доминиканская Республика',value:'+1849',country:'Доминиканская Республика'},{label:'+1868 Тринидад и Тобаго',value:'+1868',country:'Тринидад и Тобаго'},{label:'+1869 Сент-Китс и Невис',value:'+1869',country:'Сент-Китс и Невис'},{label:'+1876 Ямайка',value:'+1876',country:'Ямайка'},{label:'+20 Египет',value:'+20',country:'Египет'},{label:'+211 Южный Судан',value:'+211',country:'Южный Судан'},{label:'+212 Марокко',value:'+212',country:'Марокко'},{label:'+213 Алжир',value:'+213',country:'Алжир'},{label:'+216 Тунис',value:'+216',country:'Тунис'},{label:'+218 Ливия',value:'+218',country:'Ливия'},{label:'+21821 Ливия',value:'+21821',country:'Ливия'},{label:'+220 Гамбия',value:'+220',country:'Гамбия'},{label:'+221 Сенегал',value:'+221',country:'Сенегал'},{label:'+222 Мавритания',value:'+222',country:'Мавритания'},{label:'+223 Мали',value:'+223',country:'Мали'},{label:'+224 Гвинея',value:'+224',country:'Гвинея'},{label:'+225 Кот-д’Ивуар',value:'+225',country:'Кот-д’Ивуар'},{label:'+226 Буркина Фасо',value:'+226',country:'Буркина Фасо'},{label:'+227 Нигер',value:'+227',country:'Нигер'},{label:'+228 Того',value:'+228',country:'Того'},{label:'+229 Бенин',value:'+229',country:'Бенин'},{label:'+230 Маврикий',value:'+230',country:'Маврикий'},{label:'+231 Либерия',value:'+231',country:'Либерия'},{label:'+232 Сьерра-Леоне',value:'+232',country:'Сьерра-Леоне'},{label:'+233 Гана',value:'+233',country:'Гана'},{label:'+234 Нигерия ',value:'+234',country:'Нигерия '},{label:'+235 Чад',value:'+235',country:'Чад'},{label:'+236 Центральноафриканская Республика',value:'+236',country:'Центральноафриканская Республика'},{label:'+237 Камерун',value:'+237',country:'Камерун'},{label:'+238 Кабо-Верде',value:'+238',country:'Кабо-Верде'},{label:'+239 Сан-Томе и Принсипи',value:'+239',country:'Сан-Томе и Принсипи'},{label:'+240 Экваториальная Гвинея',value:'+240',country:'Экваториальная Гвинея'},{label:'+241 Габон',value:'+241',country:'Габон'},{label:'+242 Конго (Браззавиль)',value:'+242',country:'Конго (Браззавиль)'},{label:'+243 Дем. Респ. Конго (Киншаса)',value:'+243',country:'Дем. Респ. Конго (Киншаса)'},{label:'+244 Ангола',value:'+244',country:'Ангола'},{label:'+245 Гвинея-Бисау',value:'+245',country:'Гвинея-Бисау'},{label:'+246 Диего-Гарсия',value:'+246',country:'Диего-Гарсия'},{label:'+247 Остров Вознесения',value:'+247',country:'Остров Вознесения'},{label:'+248 Сейшелы',value:'+248',country:'Сейшелы'},{label:'+249 Судан',value:'+249',country:'Судан'},{label:'+250 Руанда',value:'+250',country:'Руанда'},{label:'+251 Эфиопия',value:'+251',country:'Эфиопия'},{label:'+252 Сомали ',value:'+252',country:'Сомали '},{label:'+253 Джибути',value:'+253',country:'Джибути'},{label:'+254 Кения',value:'+254',country:'Кения'},{label:'+255 Танзания',value:'+255',country:'Танзания'},{label:'+256 Уганда',value:'+256',country:'Уганда'},{label:'+257 Бурунди',value:'+257',country:'Бурунди'},{label:'+258 Мозамбик',value:'+258',country:'Мозамбик'},{label:'+260 Замбия',value:'+260',country:'Замбия'},{label:'+261 Мадагаскар',value:'+261',country:'Мадагаскар'},{label:'+262 Реюньон',value:'+262',country:'Реюньон'},{label:'+263 Зимбабве',value:'+263',country:'Зимбабве'},{label:'+264 Намибия',value:'+264',country:'Намибия'},{label:'+265 Малави',value:'+265',country:'Малави'},{label:'+2651 Малави',value:'+2651',country:'Малави'},{label:'+266 Лесото',value:'+266',country:'Лесото'},{label:'+267 Ботсвана',value:'+267',country:'Ботсвана'},{label:'+268 Свазиленд',value:'+268',country:'Свазиленд'},{label:'+269 Коморы',value:'+269',country:'Коморы'},{label:'+27 Южно-Африканская Респ.',value:'+27',country:'Южно-Африканская Респ.'},{label:'+290 Тристан-да-Кунья',value:'+290',country:'Тристан-да-Кунья'},{label:'+291 Эритрея',value:'+291',country:'Эритрея'},{label:'+297 Аруба',value:'+297',country:'Аруба'},{label:'+298 Фарерские острова',value:'+298',country:'Фарерские острова'},{label:'+299 Гренландия',value:'+299',country:'Гренландия'},{label:'+30 Греция',value:'+30',country:'Греция'},{label:'+31 Нидерланды',value:'+31',country:'Нидерланды'},{label:'+32 Бельгия',value:'+32',country:'Бельгия'},{label:'+33 Франция',value:'+33',country:'Франция'},{label:'+34 Испания',value:'+34',country:'Испания'},{label:'+350 Гибралтар',value:'+350',country:'Гибралтар'},{label:'+351 Португалия',value:'+351',country:'Португалия'},{label:'+352 Люксембург',value:'+352',country:'Люксембург'},{label:'+353 Ирландия',value:'+353',country:'Ирландия'},{label:'+354 Исландия',value:'+354',country:'Исландия'},{label:'+355 Албания',value:'+355',country:'Албания'},{label:'+356 Мальта',value:'+356',country:'Мальта'},{label:'+357 Кипр',value:'+357',country:'Кипр'},{label:'+358 Финляндия',value:'+358',country:'Финляндия'},{label:'+359 Болгария',value:'+359',country:'Болгария'},{label:'+36 Венгрия',value:'+36',country:'Венгрия'},{label:'+370 Литва',value:'+370',country:'Литва'},{label:'+371 Латвия',value:'+371',country:'Латвия'},{label:'+372 Эстония',value:'+372',country:'Эстония'},{label:'+373 Молдова',value:'+373',country:'Молдова'},{label:'+374 Армения',value:'+374',country:'Армения'},{label:'+375 Беларусь (Белоруссия)',value:'+375',country:'Беларусь (Белоруссия)'},{label:'+376 Андорра',value:'+376',country:'Андорра'},{label:'+377 Монако',value:'+377',country:'Монако'},{label:'+378 Сан-Марино',value:'+378',country:'Сан-Марино'},{label:'+380 Украина',value:'+380',country:'Украина'},{label:'+381 Сербия',value:'+381',country:'Сербия'},{label:'+382 Черногория',value:'+382',country:'Черногория'},{label:'+385 Хорватия',value:'+385',country:'Хорватия'},{label:'+386 Словения',value:'+386',country:'Словения'},{label:'+387 Босния и Герцеговина',value:'+387',country:'Босния и Герцеговина'},{label:'+389 Респ. Македония',value:'+389',country:'Респ. Македония'},{label:'+39 Италия',value:'+39',country:'Италия'},{label:'+396698 Ватикан',value:'+396698',country:'Ватикан'},{label:'+40 Румыния',value:'+40',country:'Румыния'},{label:'+41 Швейцария',value:'+41',country:'Швейцария'},{label:'+420 Чехия',value:'+420',country:'Чехия'},{label:'+421 Словакия',value:'+421',country:'Словакия'},{label:'+423 Лихтенштейн',value:'+423',country:'Лихтенштейн'},{label:'+43 Австрия',value:'+43',country:'Австрия'},{label:'+44 Великобритания',value:'+44',country:'Великобритания'},{label:'+45 Дания',value:'+45',country:'Дания'},{label:'+46 Швеция',value:'+46',country:'Швеция'},{label:'+47 Норвегия',value:'+47',country:'Норвегия'},{label:'+48 Польша',value:'+48',country:'Польша'},{label:'+49 Германия',value:'+49',country:'Германия'},{label:'+500 Фолклендские острова',value:'+500',country:'Фолклендские острова'},{label:'+501 Белиз',value:'+501',country:'Белиз'},{label:'+502 Гватемала',value:'+502',country:'Гватемала'},{label:'+503 Сальвадор',value:'+503',country:'Сальвадор'},{label:'+504 Гондурас',value:'+504',country:'Гондурас'},{label:'+505 Никарагуа',value:'+505',country:'Никарагуа'},{label:'+506 Коста-Рика',value:'+506',country:'Коста-Рика'},{label:'+507 Панама',value:'+507',country:'Панама'},{label:'+508 Сен-Пьер и Микелон',value:'+508',country:'Сен-Пьер и Микелон'},{label:'+509 Гаити',value:'+509',country:'Гаити'},{label:'+51 Перу',value:'+51',country:'Перу'},{label:'+52 Мексика',value:'+52',country:'Мексика'},{label:'+53 Куба',value:'+53',country:'Куба'},{label:'+54 Аргентина',value:'+54',country:'Аргентина'},{label:'+55 Бразилия',value:'+55',country:'Бразилия'},{label:'+56 Чили',value:'+56',country:'Чили'},{label:'+57 Колумбия',value:'+57',country:'Колумбия'},{label:'+58 Венесуэла',value:'+58',country:'Венесуэла'},{label:'+590 Гваделупа',value:'+590',country:'Гваделупа'},{label:'+591 Боливия',value:'+591',country:'Боливия'},{label:'+592 Гайана',value:'+592',country:'Гайана'},{label:'+593 Эквадор',value:'+593',country:'Эквадор'},{label:'+594 Фр. Гвиана',value:'+594',country:'Фр. Гвиана'},{label:'+595 Парагвай',value:'+595',country:'Парагвай'},{label:'+596 Мартиника',value:'+596',country:'Мартиника'},{label:'+597 Суринам',value:'+597',country:'Суринам'},{label:'+598 Уругвай',value:'+598',country:'Уругвай'},{label:'+599 Кюрасао',value:'+599',country:'Кюрасао'},{label:'+5999 Нидерландские Антильские острова',value:'+5999',country:'Нидерландские Антильские острова'},{label:'+60 Малайзия',value:'+60',country:'Малайзия'},{label:'+61 Австралия',value:'+61',country:'Австралия'},{label:'+62 Индонезия',value:'+62',country:'Индонезия'},{label:'+628 Индонезия ',value:'+628',country:'Индонезия '},{label:'+63 Филиппины',value:'+63',country:'Филиппины'},{label:'+64 Новая Зеландия',value:'+64',country:'Новая Зеландия'},{label:'+65 Сингапур',value:'+65',country:'Сингапур'},{label:'+66 Таиланд',value:'+66',country:'Таиланд'},{label:'+670 Восточный Тимор',value:'+670',country:'Восточный Тимор'},{label:'+67077 Восточный Тимор',value:'+67077',country:'Восточный Тимор'},{label:'+67078 Восточный Тимор',value:'+67078',country:'Восточный Тимор'},{label:'+6721 Австралийская антарктическая база',value:'+6721',country:'Австралийская антарктическая база'},{label:'+6723 Норфолк (остров)',value:'+6723',country:'Норфолк (остров)'},{label:'+673 Бруней-Даруссалам',value:'+673',country:'Бруней-Даруссалам'},{label:'+674 Науру',value:'+674',country:'Науру'},{label:'+675 Папуа-Новая Гвинея',value:'+675',country:'Папуа-Новая Гвинея'},{label:'+676 Тонга',value:'+676',country:'Тонга'},{label:'+677 Соломоновы Острова',value:'+677',country:'Соломоновы Острова'},{label:'+678 Вануату',value:'+678',country:'Вануату'},{label:'+679 Фиджи',value:'+679',country:'Фиджи'},{label:'+680 Палау',value:'+680',country:'Палау'},{label:'+681 Уоллис и Футуна',value:'+681',country:'Уоллис и Футуна'},{label:'+682 Острова Кука',value:'+682',country:'Острова Кука'},{label:'+683 Ниуэ',value:'+683',country:'Ниуэ'},{label:'+685 Самоа',value:'+685',country:'Самоа'},{label:'+686 Кирибати',value:'+686',country:'Кирибати'},{label:'+687 Новая Каледония',value:'+687',country:'Новая Каледония'},{label:'+6882 Тувалу',value:'+6882',country:'Тувалу'},{label:'+68890 Тувалу ',value:'+68890',country:'Тувалу '},{label:'+689 Французская Полинезия (Таити)',value:'+689',country:'Французская Полинезия (Таити)'},{label:'+690 Токелау',value:'+690',country:'Токелау'},{label:'+691 Ф.Ш. Микронезии',value:'+691',country:'Ф.Ш. Микронезии'},{label:'+692 Маршалловы Острова',value:'+692',country:'Маршалловы Острова'},{label:'+7 Россия',value:'+7',country:'Россия'},{label:'+76 Казахстан',value:'+76',country:'Казахстан'},{label:'+77 Казахстан',value:'+77',country:'Казахстан'},{label:'+81 Япония',value:'+81',country:'Япония'},{label:'+82 Респ. Корея',value:'+82',country:'Респ. Корея'},{label:'+84 Вьетнам',value:'+84',country:'Вьетнам'},{label:'+850 Корейская НДР',value:'+850',country:'Корейская НДР'},{label:'+850191 Корейская НДР ',value:'+850191',country:'Корейская НДР '},{label:'+852 Гонконг',value:'+852',country:'Гонконг'},{label:'+853 Макао',value:'+853',country:'Макао'},{label:'+855 Камбоджа',value:'+855',country:'Камбоджа'},{label:'+856 Лаос',value:'+856',country:'Лаос'},{label:'+85620 Лаос ',value:'+85620',country:'Лаос '},{label:'+86 Китайская Н.Р.',value:'+86',country:'Китайская Н.Р.'},{label:'+880 Бангладеш',value:'+880',country:'Бангладеш'},{label:'+886 Тайвань',value:'+886',country:'Тайвань'},{label:'+90 Турция',value:'+90',country:'Турция'},{label:'+91 Индия',value:'+91',country:'Индия'},{label:'+92 Пакистан',value:'+92',country:'Пакистан'},{label:'+93 Афганистан',value:'+93',country:'Афганистан'},{label:'+94 Шри-Ланка',value:'+94',country:'Шри-Ланка'},{label:'+95 Бирма (Мьянма)',value:'+95',country:'Бирма (Мьянма)'},{label:'+960 Мальдивские острова',value:'+960',country:'Мальдивские острова'},{label:'+961 Ливан',value:'+961',country:'Ливан'},{label:'+962 Иордания',value:'+962',country:'Иордания'},{label:'+963 Сирийская арабская республика',value:'+963',country:'Сирийская арабская республика'},{label:'+964 Ирак',value:'+964',country:'Ирак'},{label:'+965 Кувейт',value:'+965',country:'Кувейт'},{label:'+966 Саудовская Аравия',value:'+966',country:'Саудовская Аравия'},{label:'+9665 Саудовская Аравия ',value:'+9665',country:'Саудовская Аравия '},{label:'+967 Йемен',value:'+967',country:'Йемен'},{label:'+968 Оман',value:'+968',country:'Оман'},{label:'+970 Палестина',value:'+970',country:'Палестина'},{label:'+971 Объединенные Арабские Эмираты',value:'+971',country:'Объединенные Арабские Эмираты'},{label:'+9715 Объединенные Арабские Эмираты',value:'+9715',country:'Объединенные Арабские Эмираты'},{label:'+972 Израиль',value:'+972',country:'Израиль'},{label:'+9725 Израиль ',value:'+9725',country:'Израиль '},{label:'+973 Бахрейн',value:'+973',country:'Бахрейн'},{label:'+974 Катар',value:'+974',country:'Катар'},{label:'+975 Бутан',value:'+975',country:'Бутан'},{label:'+97517 Бутан',value:'+97517',country:'Бутан'},{label:'+976 Монголия',value:'+976',country:'Монголия'},{label:'+977 Непал',value:'+977',country:'Непал'},{label:'+98 Иран',value:'+98',country:'Иран'},{label:'+992 Таджикистан',value:'+992',country:'Таджикистан'},{label:'+993 Туркменистан',value:'+993',country:'Туркменистан'},{label:'+994 Азербайджан',value:'+994',country:'Азербайджан'},{label:'+995 Грузия',value:'+995',country:'Грузия'},{label:'+996 Киргизия',value:'+996',country:'Киргизия'},{label:'+998 Узбекистан',value:'+998',country:'Узбекистан'}];var maskFlag=0;function enableButton(buttonElement){var button=buttonElement||0;if(button){button.removeAttr('disabled').removeClass('btn-disable');}else{return false;}}
function disableButton(buttonElement){var button=buttonElement||0;if(button){button.attr('disabled','disabled').addClass('btn-disable');}}
function telAutocompleteInit(elem){if(!elem.length)return false;var telInt=elem,buttonAction=telInt.closest('div').find('.btn-action').length?telInt.closest('div').find('.btn-action'):telInt.closest('.popup').find('.btn-action')||telInt.closest('.popup').find('.phone-btn');var options2={mask:['+9 999 999-999','+9 999 999-99-99','+99 999 999-99-99','+999 999 999-99-99','+9999 999 999-99-99','+99999 999 999-99-99'],placeholder:' ',greedy:false,showMaskOnFocus:false,showMaskOnHover:false,oncomplete:function(){if(buttonAction.length&&buttonAction.has(':disabled')){enableButton(buttonAction);}
telInt.addClass('mask-done');},onincomplete:function(){if(buttonAction.length){disableButton(buttonAction);}}};telInt.inputmask(options2);telInt.keyup(function(){var v=$(this).val();if(v.length>=14){$('#order-received-link').css('display','inline-block');}else{$('#order-received-link').css('display','none');}});var telAutocompleate={appendTo:elem.closest('.phone-number-field'),minLength:2,autoFocus:true,source:numbreList,focus:function(event,ui){var widgetElement=$(this).autocomplete('widget'),leftPos=$(this).position().left,elemHeight=$(this).outerHeight(),topPos=$(this).position().top,widgetContainer=widgetElement.closest('.phone-numbers-list');widgetContainer.css({top:elemHeight+topPos,left:leftPos}).show();$(this).removeClass('mask-done');return false;},close:function(event,ui){var widgetElement=$(this).autocomplete('widget'),widgetStyles=widgetElement.attr('style'),widgetContainer=widgetElement.closest('.phone-numbers-list');widgetContainer.hide();},response:function(event,ui){var container=$(this).siblings('.phone-numbers-list');if(!ui.content.length){container.css('visibility','hidden');}else{container.css('visibility','visible');}},select:function(event,ui){elem.siblings('.phone-numbers-list').css('visibility','hidden');}};return telAutocompleate;}
function showCheckoutPhoneMsg(){if(maskFlag===0){$('#order-received-link').css('display','inline-block');setTimeout(function(){var el=$('#order-received-link');if(!el.hasClass('active')){$('#order-received-link').hide();}},10000);maskFlag++;}}
var telRenderItems=function(ul,item){var code=item.value;if(item.label.match(/[+]8\s/g)){code='8';}
ul.addClass('telephone-autocomplete');if(!ul.closest('.phone-numbers-list').length){ul.wrap('<div class="phone-numbers-list" />').attr('style',ul.attr('style'));}
return $("<li>").data("item.autocomplete",item).append("<a>"+"<span>"+code+"</span>"+item.country+"</a>").appendTo(ul);};window['initTels']=function(selectors){if(!selectors){selectors=$('.phone-number-field .tel-select');}
if(selectors.length<1){return;}
selectors.each(function(){var telInt=$(this);telInt.autocomplete(telAutocompleteInit(telInt)).data("autocomplete")._renderItem=telRenderItems;});selectors.each(function(){$(this).on('focus',function(){var inputValue=$(this).val(),inputElement=$(this),cityInput=$(this).siblings('.phone-numbers-list').find('.phone-find-input'),container=cityInput.closest('.phone-numbers-list');if(inputValue==''||inputValue=='+'){inputElement.val('+');inputElement.autocomplete('search','+');}else{inputElement.autocomplete('search',inputValue);}
$(this).addClass('focused');container.css('visibility','visible');});$(this).on('focusout',function(){var cityInput=$(this).siblings('.phone-numbers-list').find('.phone-find-input'),container=cityInput.closest('.phone-numbers-list');$(this).removeClass('focused');if(!cityInput.hasClass('focused')){container.css('visibility','hidden');}});});selectors.on('keyup',function(e){var inputValue=$(this).val(),key=e.keyCode||e.which,inputElement=$(this),autocompleateListBlock=inputElement.siblings('.phone-numbers-list'),letters=inputValue.match(/\D+$/g),symbols=inputValue.match(/[^$А-Яа-яA-Za-z0-9_]+/g),symbol='',numbers=inputValue.match(/\d+/g);if(symbols){symbol=symbols.toString().replace('+','');}
if(letters&&letters!='+'&&(symbol=='')){var res=$.trim(letters.toString().replace('+',''));inputElement.val(inputValue.replace(res,''));if(numbers){inputElement.val('+'+numbers.toString());}else{inputElement.val('+');}
return false;}else{}});};initTels();function moveCaretToEnd(inputObject){if(inputObject.createTextRange){var r=inputObject.createTextRange();r.collapse(false);r.select();}else{var end=inputObject.value.length;inputObject.setSelectionRange(end,end);inputObject.focus();}}
function editComment(editLink){var linkEdit=editLink||$('.edit-order-link'),commentTextBlock=linkEdit.closest('.field-comments').find('.order-comment'),commentTextareaObj=linkEdit.closest('.field-comments').find('.comment-field'),commentTextarea=$('<textarea />',{row:3,width:commentTextBlock.width()}).addClass('comment-field'),commentText=commentTextBlock.text();if(linkEdit.hasClass('edit-active')){commentText=commentTextareaObj.val();commentTextBlock.text(commentTextareaObj.val()).show();commentTextareaObj.remove();linkEdit.removeClass('edit-active').find('span').text('Редактировать');}else{linkEdit.addClass('edit-active').find('span').text('Сохранить');commentTextarea.html(commentText);if(commentTextareaObj.length<=0){commentTextarea.insertBefore(commentTextBlock);commentTextarea.each(function(){moveCaretToEnd(this);});}else{commentTextareaObj.show();}
commentTextBlock.hide();}}
$(document).on('click','.edit-order-link',function(){editComment($(this));return false;});function DeliveryDateChange(select){var selectElem=select||$('#orderRepeat'),subLabel=selectElem.siblings('.sub-label'),extraInfo=selectElem.closest('.field-wrap').siblings('.field-wrap').find('.order-extra-info'),selectValue=selectElem.find(':selected').val(),endDateInput=selectElem.closest('li').find('.end-order-field'),detailsRepeatBlock=selectElem.closest('.or-box').find('.slide-details').find('.or-repeat'),calendarLink=selectElem.closest('li').find('.end-order-field').siblings('.over-popup');var changeElements=function(value){var selectedValue=value||selectValue,selectedText=selectElem.find(':selected').text();if(selectedValue=='once'){subLabel.fadeOut(200);endDateInput.fadeOut(200,function(){if(extraInfo.length){extraInfo.fadeIn(200);}});calendarLink.fadeOut(200);}else{subLabel.fadeIn(200);if(extraInfo.length){extraInfo.fadeOut(200,function(){endDateInput.show();calendarLink.fadeIn(200);});}else{endDateInput.fadeIn(200);calendarLink.fadeIn(200);}}
if(detailsRepeatBlock.length){detailsRepeatBlock.text(selectedText);}};changeElements();selectElem.each(function(){$(this).on('change',function(){changeElements($(this).find(':selected').val());});});}
DeliveryDateChange($('#orderRepeatCalendar'));DeliveryDateChange();$('.current-order select').each(function(){DeliveryDateChange($(this));});DeliveryDateChange();DeliveryDateChange($('#currOrderRepeat'));function checkedToggle(link){var toggleLink=link||$('.checkbox-toogler'),checkBox=toggleLink.find('input[type=checkbox]');if(!checkBox.is(':checked')){checkBox.prop('checked',true);toggleLink.addClass('checked');}else{checkBox.prop('checked',false);toggleLink.removeClass('checked');}}
$(document).on('click','.checkbox-toogler',function(){checkedToggle($(this));return false;});$(document).on('click','.modifiable-block',function(){modifiableActions($(this));return false;});function modifiableActions(link){var activeLink=link||$('.modifiable-block'),modifiableValueBlock=activeLink.find('.modifiable-value'),modifiableInput=$('<input class="modifiable-input" />'),hidden=activeLink.find('input[type=hidden]');modifiableInput.val(modifiableValueBlock.text());modifiableValueBlock.hide();modifiableInput.insertBefore(activeLink);activeLink.parent().click();activeLink.parent().find('.modifiable-input').focus();activeLink.addClass('active');activeLink.parent().find('.modifiable-input').on('focusout',function(){var min=modifiableValueBlock.data('min');var v=$(this).val();if(min){v=+v;if(v<min){v=min;}}
hidden.val(v);modifiableValueBlock.text(v);modifiableValueBlock.show();$(this).remove();activeLink.removeClass('active');});}
$(document).on('click','.phone-btn:not("disabled")',function(){var btn=$(this),commonContainer=btn.closest('.popup');commonContainer.find('.callback-container').hide();commonContainer.find('.callback-success').find('.callback-success-phone').text(commonContainer.find('.tel-select').val());commonContainer.find('.callback-success').show();btn.hide();return false;});$(document).on('click','.end-callback',function(){if($('body').find('.ui-widget-overlay').length){$('body').find('.ui-widget-overlay').trigger('click');var btn=$(this),commonContainer=btn.closest('.popup');commonContainer.find('.callback-container').show();commonContainer.find('.phone-btn').attr('disabled','disabled').addClass('btn-disable').show();commonContainer.find('.tel-select').val('+').focus();commonContainer.find('.callback-success').hide();}
return false;});var openSelectTab=function(container){if(!$('.change-select-list').length){return false;}
var select=$('.change-select-list'),containerParent=container||$('.payment-body');var priceTotalCount=function(select){var selectedTabId='#'+select.find(':selected').data('selectblock'),currentPrice=5900,courierPriceBlock=$(selectedTabId).find('.courier-price-block'),countedPriceBlock=select.closest(containerParent).find('.counted-price');countedPriceBlock.coltPrice({endNumber:currentPrice+parseInt(courierPriceBlock.text()),auto:true});};select.each(function(){var selectItem=$(this),selectedTabId='#'+selectItem.find(':selected').data('selectblock');$(selectedTabId).show();if(selectItem.hasClass('price-count-functioanlity')){priceTotalCount(selectItem);}
selectItem.on('change',function(){selectItem.closest(containerParent).find('.select-tab-block').hide();$('#'+selectItem.find(':selected').data('selectblock')).fadeIn(150);if(selectItem.hasClass('price-count-functioanlity')){priceTotalCount(selectItem);}});});}($('.payment-body'));$(document).on('click','.balance-detailed .head span',function(){var headerTrigger=$(this),parentContainer=headerTrigger.closest('div'),currentHeight=parentContainer.find('table').outerHeight(),headerHeight=headerTrigger.closest('tr').outerHeight();if(parentContainer.is(':animated')||!parentContainer.length){return false;}
if(parentContainer.hasClass('collapsed')){parentContainer.animate({height:currentHeight},500,'linear',function(){parentContainer.removeClass('collapsed');});}else{parentContainer.animate({height:headerHeight},500,'linear',function(){parentContainer.addClass('collapsed');});}});$(window).on('resize',function(){var collapsedContainer=$('.balance-detailed .head span').closest('div');collapsedContainer.each(function(){if(!collapsedContainer.length){return false;}
var $this=$(this),currentHeight=$this.find('table').outerHeight(),headerHeight=$this.closest('tr:first-child').outerHeight();if(!$this.hasClass('collapsed')){$this.css({height:currentHeight});}});});});jQuery(function($){$('.cabinet-datepicker').datepicker({showOtherMonths:true,selectOtherMonths:true,dateFormat:"d MM yy"});});